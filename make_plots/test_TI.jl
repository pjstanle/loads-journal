using FlowFarm
using PyPlot
const ff = FlowFarm
include("../model.jl")

sep_arr = [4.0,7.0,10.0]

figure(1,figsize=[6.0,2.5])
for k = 1:3
sep = sep_arr[k]

    ws = 11
    ti = "low"
    x = rotor_diameter[1]*sep
    # x_vec = range(turbine_x[1],stop = turbine_x[1]+10.0*rotor_diameter[1],length=100)
    y_vec = range(-1.5*rotor_diameter[1],stop = 1.5*rotor_diameter[1],length=100)
    # z_vec = range(0.0,stop = 2.0*rotor_diameter[1],length=100)
    z = hub_height[1]
    TI = zeros(length(y_vec))

    for i = 1:length(TI)
               loc = [x,y_vec[i],z]
               # loc = [x_vec[i],0.0,z]
               # loc = [4.0*rotor_diameter,0.0,z_vec[i]]
               # TI[i] = FlowFarm.GaussianTI_stanley(loc,windfarm,windfarmstate,ambient_ti[1])
               TI[i] = ff.GaussianTI(loc,turbine_x, turbine_y, rotor_diameter, hub_height, turbine_ct, sorted_turbine_index, ambient_ti[1]; div_sigma=2.5, div_ti=1.2)
    end

    # plot((x_vec.-turbine_x[1])./rotor_diameter,TI.-ambient_ti)

    # include("TIdata.jl")
    # dat = get_TIdat(11.0,"low",sep)
    # x_TI = range(-200.0/rotor_diameter,stop=200.0/rotor_diameter,length=length(dat))
    # scatter(x_TI,dat)
    #
    # ti4 = [0.04575501, 0.04643547, 0.04496438, 0.04443735, 0.04258902,
    #        0.0443374 , 0.04366063, 0.04372797, 0.04187177, 0.0452979 ,
    #        0.04591814, 0.04709126, 0.04453512, 0.04821974, 0.04783585,
    #        0.04790189, 0.04392691, 0.05038928, 0.05089065, 0.05209241,
    #        0.04801231, 0.0537342 , 0.05382837, 0.05447246, 0.04975155,
    #        0.05357039, 0.05271557, 0.05257538, 0.0474843 , 0.05150515,
    #        0.04949279, 0.04816534, 0.04299628, 0.04563134, 0.04417517,
    #        0.04384235, 0.04069571, 0.04577235, 0.04552469, 0.04594594,
    #        0.04222642, 0.04595164, 0.04790608, 0.05144565, 0.05428191,
    #        0.06520925, 0.07075928, 0.07727041, 0.07764933, 0.08959368,
    #        0.09443531, 0.09998431, 0.09613386, 0.10496637, 0.10711304,
    #        0.11006497, 0.10499943, 0.10998377, 0.11170376, 0.11503777,
    #        0.11170686, 0.11748231, 0.11701318, 0.11835408, 0.11028215,
    #        0.11085551, 0.11078391, 0.11247868, 0.10999463, 0.11356838,
    #        0.11493086, 0.11697968, 0.11534522, 0.11714383, 0.11838199,
    #        0.12056718, 0.11999109, 0.12473414, 0.12419942, 0.12457637,
    #        0.11665927, 0.11773794, 0.11494167, 0.11297481, 0.10531958,
    #        0.10478536, 0.10172138, 0.09961788, 0.09477208, 0.09344736,
    #        0.09094587, 0.09122693, 0.09178987, 0.09959902, 0.10242428,
    #        0.10766713, 0.10840912, 0.11589442, 0.12302992, 0.1314168 ,
    #        0.13586802, 0.14585525, 0.14816011, 0.15160047, 0.14516266,
    #        0.14571787, 0.14201743, 0.13981368, 0.1311147 , 0.128442  ,
    #        0.11970039, 0.11202069, 0.09830627, 0.08904573, 0.08116576,
    #        0.07410388, 0.06736778, 0.06286136, 0.05867019, 0.05526337,
    #        0.05193227, 0.05120607, 0.05008182, 0.04966333, 0.04847429,
    #        0.05084116, 0.05070948, 0.05112216, 0.0501565 , 0.05377718,
    #        0.05341839, 0.05335128, 0.04890828, 0.04874557, 0.04899351,
    #        0.0495369 , 0.04989944, 0.05425436, 0.05487442, 0.0559409 ,
    #        0.05395353, 0.05706042, 0.05594851, 0.05515442, 0.05070945,
    #        0.05139388, 0.05003569, 0.04962244, 0.04844209, 0.05176257,
    #        0.0516345 , 0.0518306 , 0.04892718, 0.04962592, 0.04883519,
    #        0.04860093, 0.04603207, 0.04633511, 0.04596967, 0.04594264,
    #        0.04397946]
    #
    # ti7 = [0.04702573, 0.04737901, 0.0466385 , 0.04667034, 0.04457122,
    #        0.04599287, 0.04525349, 0.04540336, 0.04310582, 0.04486147,
    #        0.04517969, 0.04637197, 0.04539447, 0.04984294, 0.05060323,
    #        0.05197993, 0.04989573, 0.05440772, 0.05304134, 0.05253464,
    #        0.04871986, 0.0523676 , 0.05088056, 0.05090815, 0.04745971,
    #        0.05001102, 0.05180407, 0.0548605 , 0.05573157, 0.06155889,
    #        0.06261029, 0.06433977, 0.06059789, 0.06269013, 0.06059449,
    #        0.05952261, 0.05720853, 0.06002653, 0.05900971, 0.05923849,
    #        0.05620102, 0.05937658, 0.06089915, 0.06364699, 0.0648393 ,
    #        0.07358313, 0.07887842, 0.08501648, 0.08616116, 0.09295474,
    #        0.09479122, 0.09790097, 0.09746765, 0.10871804, 0.11283105,
    #        0.11862136, 0.11632124, 0.12940005, 0.13249312, 0.13692684,
    #        0.13103984, 0.13653918, 0.1388138 , 0.14209657, 0.13984171,
    #        0.14594788, 0.14419774, 0.14327734, 0.1342819 , 0.1306351 ,
    #        0.12724129, 0.12464401, 0.12042352, 0.1183025 , 0.11573692,
    #        0.11402863, 0.10999571, 0.11222404, 0.11017301, 0.1091802 ,
    #        0.10169575, 0.10676099, 0.10285683, 0.10034083, 0.08944062,
    #        0.09142801, 0.09015398, 0.09161278, 0.08838924, 0.09510088,
    #        0.09839778, 0.10395124, 0.10304554, 0.11013758, 0.11439893,
    #        0.1205267 , 0.12295936, 0.13218453, 0.13615448, 0.14220209,
    #        0.14472614, 0.15605336, 0.16124328, 0.16735485, 0.16527557,
    #        0.17156126, 0.17121502, 0.17167137, 0.16284115, 0.16062408,
    #        0.15396509, 0.1481556 , 0.13693806, 0.13323822, 0.12330733,
    #        0.1141739 , 0.09950877, 0.09202312, 0.0840649 , 0.0766928 ,
    #        0.06805448, 0.06270207, 0.05759022, 0.05335098, 0.04975243,
    #        0.04749574, 0.04578971, 0.04490806, 0.04438886, 0.04444417,
    #        0.0438213 , 0.04392318, 0.04372161, 0.04645825, 0.04756751,
    #        0.04945513, 0.0482233 , 0.05223893, 0.05242824, 0.05322132,
    #        0.0509646 , 0.05298152, 0.05207191, 0.05160317, 0.04940803,
    #        0.0507617 , 0.04885191, 0.04751835, 0.0450047 , 0.04537812,
    #        0.04420932, 0.04354667, 0.04156063, 0.04247208, 0.04138799,
    #        0.04088435, 0.03837492, 0.03885107, 0.03793381, 0.03766043,
    #        0.03632362]
    #
    # ti10 = [0.04396764, 0.0407543 , 0.03855712, 0.03755291, 0.0379601 ,
    #        0.03608105, 0.03552445, 0.03634828, 0.03807423, 0.03761787,
    #        0.03802212, 0.03927217, 0.0410697 , 0.03946352, 0.03895408,
    #        0.03959512, 0.04082705, 0.04054394, 0.04145544, 0.04348855,
    #        0.04628403, 0.04667092, 0.04824933, 0.05091817, 0.05395298,
    #        0.05517406, 0.05760876, 0.06112907, 0.06386458, 0.06534649,
    #        0.06782473, 0.07121128, 0.0732823 , 0.07374627, 0.07510531,
    #        0.07733705, 0.0801493 , 0.08194366, 0.0850349 , 0.08933393,
    #        0.09358045, 0.09558652, 0.09939045, 0.10485727, 0.11092301,
    #        0.11100737, 0.11255827, 0.115584  , 0.12056564, 0.11687196,
    #        0.11412697, 0.11245871, 0.11160919, 0.10955068, 0.10842135,
    #        0.10828857, 0.1100452 , 0.11034635, 0.11176708, 0.11431404,
    #        0.11735406, 0.1164327 , 0.11645223, 0.11745811, 0.11794074,
    #        0.11433483, 0.11192082, 0.11082068, 0.11186899, 0.10721714,
    #        0.10363284, 0.10126933, 0.10411719, 0.0976092 , 0.09272913,
    #        0.0897765 , 0.08948007, 0.08687125, 0.08603644, 0.08702697,
    #        0.08841029, 0.08959112, 0.09229193, 0.09637988, 0.10006589,
    #        0.0963855 , 0.09437916, 0.09410143, 0.09526829, 0.09507786,
    #        0.09779789, 0.10302999, 0.10980098, 0.11294584, 0.1179104 ,
    #        0.12436558, 0.13143492, 0.12966748, 0.12966409, 0.13130475,
    #        0.13662382, 0.13639999, 0.13754327, 0.13994031, 0.14292567,
    #        0.14371322, 0.14507589, 0.14697869, 0.14595137, 0.14072884,
    #        0.13636022, 0.13287482, 0.12970395, 0.12071196, 0.11277799,
    #        0.10604902, 0.10136041, 0.09477207, 0.08903877, 0.08430189,
    #        0.07876895, 0.07305767, 0.06805584, 0.06390241, 0.06083983,
    #        0.0545483 , 0.04967931, 0.04665224, 0.04619972, 0.04306751,
    #        0.04177522, 0.04247077, 0.04449013, 0.043352  , 0.04333664,
    #        0.04443365, 0.04620288, 0.04436196, 0.04329578, 0.04306086,
    #        0.04376982, 0.04219267, 0.0413128 , 0.04117506, 0.04232179,
    #        0.03974909, 0.0378519 , 0.03673206, 0.03800107, 0.03576026,
    #        0.03442526, 0.03409449, 0.03539165, 0.03449081, 0.03414359,
    #        0.03436552, 0.03456214, 0.03377004, 0.03387953, 0.0348769 ,
    #        0.0365012 ]

    #ll m/s data LOW TI

    if ti == "low"
        if ws == 11
        ti4 = [0.04289337, 0.04638665, 0.04690902, 0.0485604 , 0.04690602,
               0.05001581, 0.05011281, 0.05059038, 0.04728802, 0.04985407,
               0.04724027, 0.04516639, 0.03922078, 0.04025781, 0.03905578,
               0.03865912, 0.03567901, 0.03806708, 0.03688827, 0.03648667,
               0.03349461, 0.03601086, 0.03460901, 0.03407214, 0.02929139,
               0.03059327, 0.03016168, 0.03050581, 0.02737196, 0.0292499 ,
               0.02845378, 0.02817936, 0.02541082, 0.02891147, 0.03036855,
               0.03266999, 0.0321499 , 0.03944506, 0.04194908, 0.04483225,
               0.04313328, 0.04653748, 0.04840215, 0.05097883, 0.0555812 ,
               0.06436095, 0.07362402, 0.08419668, 0.09853898, 0.12409244,
               0.13952718, 0.15612778, 0.16129314, 0.18580393, 0.19289154,
               0.20072097, 0.18612716, 0.18290649, 0.17698752, 0.17199017,
               0.16102642, 0.15421745, 0.14226886, 0.13173172, 0.11619795,
               0.10898459, 0.10184632, 0.09702026, 0.08509388, 0.08961141,
               0.08459047, 0.08130087, 0.06777413, 0.07642838, 0.07155315,
               0.06820943, 0.05671368, 0.06291976, 0.06086284, 0.06053863,
               0.05540125, 0.06298598, 0.06408114, 0.06629026, 0.0622307 ,
               0.06818043, 0.0690366 , 0.07087432, 0.0681468 , 0.07913906,
               0.07469009, 0.07270226, 0.06048725, 0.0725434 , 0.07655331,
               0.08431802, 0.08467315, 0.09779165, 0.10935962, 0.1241754 ,
               0.13712702, 0.16060024, 0.16542344, 0.17154961, 0.15851969,
               0.15625823, 0.14702706, 0.13955783, 0.12532936, 0.11889859,
               0.10699817, 0.09664326, 0.08075727, 0.07183389, 0.06529027,
               0.06026798, 0.05576427, 0.05796436, 0.05661654, 0.0563046 ,
               0.05160662, 0.05617038, 0.0537871 , 0.05208646, 0.04525118,
               0.04804998, 0.04573663, 0.04425602, 0.0379841 , 0.038228  ,
               0.03640432, 0.03527923, 0.03363149, 0.03695833, 0.03673314,
               0.03726286, 0.035231  , 0.03975986, 0.04075145, 0.04312755,
               0.04328559, 0.05026748, 0.05306481, 0.05653509, 0.05450588,
               0.05658558, 0.05493962, 0.05376683, 0.050378  , 0.05125792,
               0.05022327, 0.05013875, 0.04797699, 0.05033244, 0.0503385 ,
               0.05139569, 0.05210332, 0.05813819, 0.05923527, 0.06092186,
               0.05813165]
        # ti4 = [       0.0,        0.0,        0.0,        0.0,        0.0,
        #    0.04943997, 0.04957042, 0.04918214, 0.0482769 , 0.04730902,
        #    0.04638809, 0.04519667, 0.04377571, 0.04255102, 0.04158358,
        #    0.0404959 , 0.03935138, 0.03858597, 0.03821768, 0.03768216,
        #    0.03686031, 0.03616323, 0.03566535, 0.0349146 , 0.0339594 ,
        #    0.03318164, 0.03267046, 0.03195011, 0.03109693, 0.03063042,
        #    0.03069692, 0.03082308, 0.03103921, 0.03191814, 0.03331933,
        #    0.03473757, 0.03604459, 0.03780672, 0.0400376 , 0.04240342,
        #    0.04505091, 0.04868048, 0.0535431 , 0.0594801 , 0.06688508,
        #    0.07657073, 0.08781553, 0.09993489, 0.11244256, 0.1261477 ,
        #    0.13960195, 0.15194735, 0.16217803, 0.17130756, 0.17890103,
        #    0.18438623, 0.18756011, 0.18901736, 0.18856275, 0.1855153 ,
        #    0.17983309, 0.17225909, 0.16350468, 0.15306085, 0.14139998,
        #    0.12986824, 0.11960055, 0.11016917, 0.10118862, 0.09362744,
        #    0.08759408, 0.08212625, 0.07688717, 0.07290774, 0.07042591,
        #    0.06790952, 0.06553402, 0.0645694 , 0.06536387, 0.06618378,
        #    0.0669936 , 0.068592  , 0.07083486, 0.07220919, 0.07275948,
        #    0.07336234, 0.07401443, 0.07368109, 0.0726739 , 0.07301739,
        #    0.07502389, 0.07766132, 0.08104508, 0.08651503, 0.09374429,
        #    0.10188616, 0.11130815, 0.12260784, 0.13401886, 0.14405639,
        #    0.1519535 , 0.15845348, 0.1631943 , 0.16563362, 0.16574945,
        #    0.16402897, 0.16044576, 0.15442829, 0.14645088, 0.13728625,
        #    0.12777119, 0.1172877 , 0.10643551, 0.09599006, 0.08686482,
        #    0.07864904, 0.07141491, 0.06563318, 0.06148859, 0.05820122,
        #    0.05542685, 0.0534967 , 0.05223003, 0.050816  , 0.04920399,
        #    0.04783271, 0.0467499 , 0.04538212, 0.04380928, 0.04260282,
        #    0.04188309, 0.04108826, 0.04025542, 0.04000292, 0.04029715,
        #    0.04060962, 0.04108436, 0.04223797, 0.04396615, 0.04569885,
        #    0.04730697, 0.04898396, 0.05066625, 0.05191279, 0.05279926,
        #    0.05367018, 0.05443829, 0.05473267, 0.05457387, 0.0543136 ,
        #    0.05406576, 0.05371987, 0.05338656, 0.05344798, 0.05389018,
        #    0.05439639, 0.05486686, 0.05510146, 0.05556444, 0.05595156,
        #    0.05636427]
        ti7 = [0.05860653, 0.06220161, 0.06112004, 0.06051639, 0.05682122,
               0.05637791, 0.05543119, 0.05498898, 0.05305088, 0.0536201 ,
               0.05059103, 0.04808857, 0.04316574, 0.04206507, 0.03988314,
               0.0386897 , 0.03665328, 0.03794354, 0.0382103 , 0.03934494,
               0.03816684, 0.04026572, 0.03859863, 0.03761453, 0.03294112,
               0.03204534, 0.03060153, 0.0304375 , 0.028355  , 0.03017377,
               0.02975702, 0.03061288, 0.02925575, 0.0345495 , 0.03606996,
               0.03859503, 0.0366713 , 0.04339459, 0.04625889, 0.04985671,
               0.05044   , 0.05817517, 0.06415418, 0.07096833, 0.07649269,
               0.08806468, 0.09687775, 0.10687596, 0.11342239, 0.12435938,
               0.13034746, 0.13719663, 0.13837086, 0.14263632, 0.14349351,
               0.14506375, 0.14544726, 0.15021408, 0.14936179, 0.14944969,
               0.14478282, 0.14467894, 0.14080522, 0.1382859 , 0.13107586,
               0.13029092, 0.12629413, 0.12368056, 0.11459676, 0.11322371,
               0.11115649, 0.11071755, 0.10899439, 0.11416223, 0.11403149,
               0.11544104, 0.11445165, 0.12061021, 0.11128541, 0.10294605,
               0.08441929, 0.07344658, 0.0650419 , 0.05926503, 0.05419819,
               0.05808288, 0.05662906, 0.05751264, 0.05156701, 0.06165801,
               0.06810313, 0.07726001, 0.08280474, 0.09958715, 0.10942288,
               0.1205281 , 0.12638844, 0.14134481, 0.14553868, 0.1508151 ,
               0.14920304, 0.15549025, 0.15332399, 0.15266423, 0.14180886,
               0.14375292, 0.14401716, 0.14566605, 0.14073129, 0.14799587,
               0.14537318, 0.14365696, 0.13349772, 0.13314705, 0.12754924,
               0.12295338, 0.11321833, 0.11041467, 0.10292493, 0.09613421,
               0.08417429, 0.07691376, 0.0681012 , 0.06065861, 0.0519353 ,
               0.05005328, 0.04798726, 0.04707826, 0.04274844, 0.04357314,
               0.04222304, 0.04159104, 0.03870284, 0.04108736, 0.04082078,
               0.04133589, 0.03967667, 0.04272595, 0.04341738, 0.04505009,
               0.04550455, 0.04894832, 0.04910788, 0.04983655, 0.04749381,
               0.04851563, 0.04794285, 0.04800349, 0.04632044, 0.04857739,
               0.04800836, 0.04796088, 0.04633199, 0.0467672 , 0.04567286,
               0.04547362, 0.04538546, 0.04777909, 0.04790759, 0.04867528,
               0.04851594]
        ti10 = [0.05376017, 0.05251175, 0.05170878, 0.05137546, 0.05160265,
               0.0500287 , 0.04924973, 0.04930322, 0.05005633, 0.04748304,
               0.04525982, 0.04343439, 0.04229688, 0.03813591, 0.03501843,
               0.03320449, 0.03234201, 0.03190848, 0.03246634, 0.03395742,
               0.03632512, 0.03549731, 0.03525502, 0.03561175, 0.03652011,
               0.03476894, 0.03382951, 0.03377599, 0.03315291, 0.03288368,
               0.0339069 , 0.03613023, 0.0382025 , 0.03806409, 0.03940083,
               0.04208221, 0.04544784, 0.04557938, 0.04683317, 0.04913495,
               0.05187974, 0.0553234 , 0.06096357, 0.06834189, 0.07527585,
               0.08030116, 0.08653976, 0.09382203, 0.10177412, 0.10261917,
               0.10455184, 0.10757158, 0.11122012, 0.11275475, 0.11541161,
               0.11916627, 0.12281703, 0.12137356, 0.12102348, 0.12181472,
               0.12424566, 0.11953255, 0.11652624, 0.11545663, 0.11700072,
               0.11353835, 0.11090697, 0.10925355, 0.10967623, 0.10365558,
               0.09892728, 0.09583092, 0.09291943, 0.08998171, 0.0883083 ,
               0.08803245, 0.08863435, 0.08686516, 0.08663607, 0.08800204,
               0.09099664, 0.08463442, 0.08010455, 0.0777944 , 0.07797019,
               0.07429685, 0.0737097 , 0.07626889, 0.0833844 , 0.08411594,
               0.08754804, 0.09325126, 0.10075624, 0.1061896 , 0.11371666,
               0.12280427, 0.12740655, 0.12848768, 0.13071862, 0.13396454,
               0.13482552, 0.13008568, 0.12660581, 0.12439463, 0.12222931,
               0.12074417, 0.12091642, 0.12263627, 0.12464736, 0.12296423,
               0.12207834, 0.12195827, 0.12321889, 0.11851232, 0.1146972 ,
               0.11181114, 0.10973504, 0.10418598, 0.09960443, 0.09608801,
               0.09262626, 0.08701433, 0.08213578, 0.07811175, 0.07467975,
               0.06820044, 0.06239416, 0.05745275, 0.05397272, 0.04964674,
               0.04610281, 0.04351861, 0.04007593, 0.03774503, 0.03620482,
               0.03555367, 0.0342177 , 0.03280306, 0.03252424, 0.03341467,
               0.03504642, 0.03341675, 0.03293709, 0.0336522 , 0.03464503,
               0.03312805, 0.03321884, 0.03488759, 0.0366294 , 0.0367888 ,
               0.03802368, 0.04023506, 0.04208378, 0.04066239, 0.04006101,
               0.04031684, 0.04132503, 0.03973584, 0.0394543 , 0.04048708,
               0.04213565]
        elseif ws == 12
            ti4 = [0.04185869, 0.04248357, 0.04113686, 0.04065392, 0.03895815,
           0.04055534, 0.03993662, 0.03999845, 0.03830216, 0.04143417,
           0.0420045 , 0.04308061, 0.04075142, 0.04412833, 0.04377514,
           0.04383361, 0.04018926, 0.04609031, 0.04654658, 0.04764328,
           0.04391731, 0.0491586 , 0.04925213, 0.0498489 , 0.04553514,
           0.04904476, 0.04826834, 0.04814619, 0.04348359, 0.04717422,
           0.04533042, 0.04411389, 0.03937057, 0.04177857, 0.04043524,
           0.04012032, 0.03722659, 0.04185227, 0.04160623, 0.04197096,
           0.03855322, 0.04192582, 0.04367597, 0.04686676, 0.04940383,
           0.05927215, 0.06424795, 0.07008348, 0.07036596, 0.08104551,
           0.08530932, 0.09019762, 0.08665997, 0.09441383, 0.09618972,
           0.09867825, 0.09406027, 0.09831273, 0.09967759, 0.10246994,
           0.09934915, 0.10421767, 0.10366496, 0.10471009, 0.09751621,
           0.09783759, 0.09771658, 0.09915089, 0.09702518, 0.10010173,
           0.10126906, 0.10303996, 0.10161861, 0.10316538, 0.10425189,
           0.10617242, 0.10565998, 0.10986062, 0.10936629, 0.10967554,
           0.10261146, 0.10350648, 0.10099489, 0.09921548, 0.09245472,
           0.09191947, 0.08922227, 0.08736896, 0.08319797, 0.08205152,
           0.07992179, 0.08023631, 0.08085863, 0.08783495, 0.09047576,
           0.09526267, 0.09609799, 0.10290952, 0.10943133, 0.11708344,
           0.12127037, 0.13040375, 0.13275678, 0.13612539, 0.13073819,
           0.13162014, 0.12856152, 0.12683308, 0.11914012, 0.11694236,
           0.10914532, 0.10228865, 0.08985044, 0.08150109, 0.07436224,
           0.06795793, 0.061809  , 0.05772046, 0.05390008, 0.05079644,
           0.04774185, 0.04708645, 0.04606017, 0.04568275, 0.04458939,
           0.04676767, 0.0466456 , 0.04702422, 0.04613206, 0.04946122,
           0.04912967, 0.04906636, 0.04498406, 0.04484515, 0.04507311,
           0.04557294, 0.04589775, 0.04989964, 0.05046896, 0.05144889,
           0.04962008, 0.05247602, 0.05145433, 0.05072488, 0.04663881,
           0.04726803, 0.0460217 , 0.04564435, 0.04456345, 0.04762313,
           0.04750694, 0.04768903, 0.04501478, 0.04565234, 0.04492497,
           0.04470955, 0.04234956, 0.04262499, 0.04229255, 0.04227144,
           0.0404755 ]
            ti7 =[0.04298568, 0.04330724, 0.04263346, 0.04266565, 0.04075233,
           0.04205646, 0.04138005, 0.04151678, 0.03941237, 0.04101452,
           0.04130254, 0.04238951, 0.04149521, 0.04556018, 0.04625062,
           0.04750424, 0.04559199, 0.04970831, 0.04845505, 0.04798732,
           0.04449925, 0.04782739, 0.04646812, 0.04649218, 0.04334407,
           0.04567768, 0.04731075, 0.05009718, 0.05087839, 0.05619258,
           0.05714405, 0.05871402, 0.05528359, 0.05717966, 0.05525989,
           0.05427416, 0.05215611, 0.05471389, 0.05376277, 0.05394658,
           0.0511514 , 0.0540108 , 0.05535492, 0.05780926, 0.0588524 ,
           0.06674401, 0.07150584, 0.07702517, 0.07802023, 0.08410429,
           0.08570676, 0.0884566 , 0.08799363, 0.0980248 , 0.10162075,
           0.10671506, 0.10454157, 0.11611108, 0.1187204 , 0.12251734,
           0.11712186, 0.12181613, 0.12366296, 0.12639599, 0.1242374 ,
           0.1294227 , 0.1277295 , 0.12677145, 0.11874082, 0.11540977,
           0.11235091, 0.10999773, 0.10624866, 0.10434358, 0.10202955,
           0.10047279, 0.09685533, 0.09871473, 0.09688084, 0.09597818,
           0.08945031, 0.09389651, 0.09049608, 0.08831473, 0.0787964 ,
           0.08058507, 0.07955733, 0.0809397 , 0.0782246 , 0.08427726,
           0.08735282, 0.09244108, 0.09178936, 0.09823477, 0.1021608 ,
           0.10776232, 0.11003633, 0.11840279, 0.12207303, 0.12761256,
           0.13000669, 0.14031355, 0.14513741, 0.15079876, 0.14915597,
           0.15499481, 0.15486047, 0.15544836, 0.14766058, 0.14582686,
           0.13996563, 0.13485719, 0.12481787, 0.12160448, 0.11265922,
           0.10442184, 0.09108721, 0.08430412, 0.07705613, 0.07033714,
           0.06243556, 0.0575517 , 0.05287546, 0.04899775, 0.04569726,
           0.04363741, 0.04207242, 0.04126474, 0.04078033, 0.04083547,
           0.04026357, 0.04035757, 0.04017217, 0.04269695, 0.04371997,
           0.04545861, 0.04432285, 0.04801637, 0.0481916 , 0.04892183,
           0.04684255, 0.04869411, 0.04785866, 0.04742838, 0.04541024,
           0.04665098, 0.04490003, 0.04367841, 0.04137733, 0.04172514,
           0.04065503, 0.04005017, 0.03822715, 0.03906577, 0.03806898,
           0.03760607, 0.03529726, 0.03573248, 0.03489136, 0.03464238,
           0.03341979]
            ti10 =[0.04017479, 0.0372403 , 0.03523414, 0.034318  , 0.0346915 ,
           0.03297569, 0.03246842, 0.03322282, 0.03480126, 0.0343779 ,
           0.034741  , 0.03587662, 0.03751255, 0.03604126, 0.03557181,
           0.03615292, 0.03727298, 0.03701394, 0.03784549, 0.03970094,
           0.04225221, 0.04260099, 0.04403718, 0.0464682 , 0.049231  ,
           0.05033517, 0.05254583, 0.05574554, 0.05822782, 0.05956553,
           0.06181055, 0.06488206, 0.06675908, 0.06715482, 0.06836473,
           0.07036747, 0.07290046, 0.07449318, 0.07726208, 0.08112432,
           0.08493132, 0.08670668, 0.09010964, 0.09501527, 0.10045269,
           0.1004598 , 0.10179215, 0.10445439, 0.10887725, 0.10545891,
           0.10290001, 0.10131388, 0.10046919, 0.09855262, 0.09747307,
           0.09728945, 0.09881094, 0.09901086, 0.10021334, 0.10242212,
           0.10508671, 0.10417952, 0.10411373, 0.1049279 , 0.1052608 ,
           0.1019855 , 0.09977589, 0.0987388 , 0.09959077, 0.09540372,
           0.09216977, 0.09002378, 0.09248776, 0.08668505, 0.08233054,
           0.07968898, 0.07937223, 0.07705886, 0.07631912, 0.07719855,
           0.07842372, 0.07947825, 0.08188147, 0.0855159 , 0.08881625,
           0.0856019 , 0.08387074, 0.08367402, 0.08476225, 0.08469198,
           0.08721501, 0.09198444, 0.09812655, 0.10105369, 0.10561496,
           0.11152059, 0.11798971, 0.11654953, 0.11668975, 0.11830819,
           0.12324596, 0.12317086, 0.12432873, 0.12662073, 0.12946208,
           0.13024892, 0.13155727, 0.13335627, 0.13253288, 0.12790191,
           0.12403759, 0.12096882, 0.11818814, 0.11008128, 0.10292579,
           0.09685847, 0.09264348, 0.08665199, 0.08143813, 0.07713212,
           0.07209396, 0.06688895, 0.06233008, 0.05854532, 0.05575301,
           0.04999678, 0.04554246, 0.04277532, 0.04237044, 0.03950376,
           0.03832414, 0.03896803, 0.04083015, 0.03979243, 0.03978508,
           0.04079909, 0.04242785, 0.04073906, 0.03976161, 0.03954753,
           0.04019741, 0.03874968, 0.0379423 , 0.03781649, 0.03886793,
           0.03650837, 0.03476889, 0.03374319, 0.03490965, 0.03285535,
           0.03163284, 0.03133289, 0.03252792, 0.0317018 , 0.03138446,
           0.03159026, 0.03177261, 0.03104737, 0.03115095, 0.03207101,
           0.03356814]
       elseif ws == 13
           ti4 =[0.04329518, 0.04886292, 0.04988223, 0.05148316, 0.04917965,
           0.05256754, 0.05207361, 0.052325  , 0.04844878, 0.0513027 ,
           0.05139184, 0.05217971, 0.05004865, 0.05360255, 0.05364819,
           0.05438276, 0.05177067, 0.05404006, 0.05320785, 0.05290062,
           0.04931077, 0.05048705, 0.04982006, 0.04966391, 0.04814465,
           0.05190354, 0.05157121, 0.05189508, 0.04892902, 0.0528106 ,
           0.05135546, 0.05082124, 0.04653874, 0.05031526, 0.04997295,
           0.0500949 , 0.04548594, 0.04865884, 0.04834663, 0.0487703 ,
           0.04608559, 0.05107627, 0.05296304, 0.05568943, 0.05536979,
           0.06084567, 0.06323818, 0.06636126, 0.06669137, 0.07468493,
           0.07987416, 0.08566125, 0.08877826, 0.10369718, 0.10701338,
           0.11049434, 0.10227718, 0.10884085, 0.10750474, 0.10705621,
           0.09694697, 0.0994711 , 0.0974296 , 0.09661811, 0.09050836,
           0.09622515, 0.09595927, 0.09687655, 0.08795218, 0.09104553,
           0.08916151, 0.08831209, 0.07906911, 0.08431267, 0.08549158,
           0.08809994, 0.08299993, 0.0921651 , 0.09283111, 0.09446978,
           0.08727312, 0.09554253, 0.09607755, 0.09794921, 0.09020769,
           0.09762106, 0.09739931, 0.09770395, 0.08931331, 0.09227688,
           0.08882593, 0.08616112, 0.07939396, 0.08110398, 0.07852194,
           0.07753569, 0.07168169, 0.07437136, 0.07403546, 0.07464012,
           0.07054322, 0.07583594, 0.0767545 , 0.07885241, 0.07711364,
           0.08630781, 0.08576694, 0.08625367, 0.077937  , 0.07922312,
           0.07640933, 0.07471998, 0.0688565 , 0.07024268, 0.06708739,
           0.06482182, 0.05800444, 0.05683643, 0.05464707, 0.05337259,
           0.04883513, 0.05013074, 0.04807779, 0.04669102, 0.04222201,
           0.04429878, 0.0438164 , 0.04406407, 0.0408024 , 0.04287178,
           0.04189823, 0.04152524, 0.0386289 , 0.04113359, 0.03992234,
           0.03912279, 0.03453746, 0.03438307, 0.03231799, 0.03107947,
           0.02899572, 0.03283699, 0.03304832, 0.03384971, 0.03022712,
           0.03281602, 0.03236868, 0.03259741, 0.03015107, 0.03190025,
           0.03209385, 0.03281968, 0.03180603, 0.03470484, 0.0344579 ,
           0.03451541, 0.03157241, 0.03464777, 0.0340024 , 0.03365694,
           0.03031362]
           ti7 = [0.03860223, 0.04176785, 0.04213156, 0.04303381, 0.04039597,
           0.04285346, 0.04335973, 0.04472466, 0.04442331, 0.04911865,
           0.05061705, 0.05259418, 0.05060252, 0.05381096, 0.05329531,
           0.0533128 , 0.04981507, 0.05082799, 0.05016907, 0.05002894,
           0.04755727, 0.04827093, 0.04796786, 0.04818661, 0.04705167,
           0.04761796, 0.04801824, 0.04904756, 0.05017942, 0.05456201,
           0.05608543, 0.05836666, 0.05726333, 0.06270391, 0.06413794,
           0.06608968, 0.06380678, 0.06790286, 0.06892494, 0.07048826,
           0.06834348, 0.07349359, 0.0755853 , 0.07834804, 0.07841809,
           0.08662431, 0.08954958, 0.09322945, 0.09235975, 0.09744919,
           0.09843461, 0.10021041, 0.09702446, 0.09873104, 0.09678066,
           0.09555096, 0.09233124, 0.09549795, 0.09430359, 0.09414995,
           0.08997386, 0.09342299, 0.09331653, 0.09422582, 0.09121461,
           0.09722752, 0.09600644, 0.0957058 , 0.08660227, 0.08575206,
           0.08420339, 0.08380927, 0.08128869, 0.08285001, 0.08134418,
           0.08070172, 0.07717813, 0.0747023 , 0.07157761, 0.06972176,
           0.06598863, 0.06559397, 0.06427041, 0.06388633, 0.06166515,
           0.06341108, 0.06136216, 0.0608516 , 0.05872278, 0.06399113,
           0.06624648, 0.07029477, 0.07059561, 0.07879343, 0.08128103,
           0.08494192, 0.08441572, 0.08956892, 0.09075849, 0.09315053,
           0.09092325, 0.09759942, 0.09633487, 0.09626103, 0.09096043,
           0.095254  , 0.09215097, 0.08996071, 0.07974254, 0.07755708,
           0.07306044, 0.06953615, 0.06545749, 0.06891678, 0.06865528,
           0.06921096, 0.06378918, 0.06360608, 0.0610652 , 0.05894452,
           0.05347324, 0.05273613, 0.05033734, 0.04869647, 0.04583288,
           0.04767886, 0.04634859, 0.04576318, 0.04216716, 0.04364493,
           0.0421347 , 0.04142107, 0.037498  , 0.0388845 , 0.03685733,
           0.03552675, 0.0312506 , 0.03192143, 0.03097315, 0.03114356,
           0.03017542, 0.03235934, 0.03203467, 0.03250974, 0.03121905,
           0.03310079, 0.03391631, 0.03553408, 0.03595718, 0.03868201,
           0.03878109, 0.03946321, 0.03772002, 0.0383181 , 0.03696964,
           0.03601452, 0.03366799, 0.03488981, 0.03473362, 0.03510739,
           0.03373448]
           ti10 = [0.04605409, 0.04519183, 0.04515935, 0.04595613, 0.04620371,
           0.04472668, 0.04412948, 0.04444727, 0.04568904, 0.04532438,
           0.04597609, 0.0476024 , 0.04918188, 0.04756154, 0.04657524,
           0.04625633, 0.04578562, 0.04436389, 0.04374118, 0.04394485,
           0.04429412, 0.04399848, 0.0442587 , 0.04507059, 0.04579987,
           0.0451913 , 0.04527387, 0.04605065, 0.04737089, 0.04668075,
           0.04662581, 0.04720944, 0.04797027, 0.0470549 , 0.04696387,
           0.04770876, 0.04822632, 0.04751561, 0.04809283, 0.04994209,
           0.05207187, 0.05397727, 0.05721026, 0.06160813, 0.06674823,
           0.06769152, 0.06932617, 0.07162467, 0.07488799, 0.07379387,
           0.07343312, 0.07383193, 0.07343622, 0.073013  , 0.07345352,
           0.07477129, 0.07625848, 0.07565174, 0.0759691 , 0.07724098,
           0.07926925, 0.07621462, 0.07378444, 0.07208991, 0.07138185,
           0.06944907, 0.06921051, 0.07077641, 0.07214149, 0.07275352,
           0.07476106, 0.07812408, 0.08057233, 0.07828039, 0.07696828,
           0.07674304, 0.07747822, 0.07285568, 0.06915424, 0.06655824,
           0.0659436 , 0.06462428, 0.06490893, 0.06675327, 0.06877254,
           0.06785453, 0.06802309, 0.06924406, 0.07128441, 0.06920537,
           0.0686819 , 0.06970984, 0.07153985, 0.07258978, 0.07530202,
           0.07942513, 0.08295727, 0.08298226, 0.0845905 , 0.08760653,
           0.09017869, 0.08765583, 0.08640337, 0.08640288, 0.08763129,
           0.08271304, 0.0790081 , 0.07659692, 0.07622808, 0.07203979,
           0.06873486, 0.06639577, 0.06670841, 0.06341605, 0.0608712 ,
           0.05915148, 0.05888571, 0.05590323, 0.05398066, 0.05320666,
           0.0527217 , 0.05089462, 0.04982105, 0.04953306, 0.0488858 ,
           0.04682579, 0.04567599, 0.04549416, 0.04534125, 0.04346378,
           0.04228292, 0.04185573, 0.04118573, 0.03723432, 0.03440138,
           0.03298101, 0.03198851, 0.02965681, 0.02867358, 0.02917883,
           0.03000776, 0.02843826, 0.02794786, 0.02858807, 0.02980654,
           0.02911278, 0.02940416, 0.03064729, 0.03249004, 0.03086696,
           0.03014847, 0.03039737, 0.03119423, 0.0301434 , 0.02984581,
           0.03032071, 0.03099782, 0.03057854, 0.03090273, 0.03194635,
           0.03267935]
       end


    elseif ti == "high"
        #ll m/s data HIGH TI
    #     ti4 = [0.07450777, 0.07852303, 0.07904828, 0.08021647, 0.07664161,
    #            0.07931183, 0.07827504, 0.07784244, 0.07361922, 0.07626929,
    #            0.07429434, 0.07294329, 0.06892779, 0.07360309, 0.07369416,
    #            0.07482061, 0.07067756, 0.07482393, 0.07536327, 0.07645879,
    #            0.07338694, 0.07311056, 0.07313829, 0.07346936, 0.07295764,
    #            0.07550668, 0.07551151, 0.07590874, 0.07379749, 0.07731601,
    #            0.07597568, 0.07530535, 0.07021764, 0.06989591, 0.06987923,
    #            0.07063887, 0.06975267, 0.07304203, 0.0744214 , 0.0766151 ,
    #            0.0767019 , 0.08403266, 0.08792797, 0.0925197 , 0.09502567,
    #            0.1120037 , 0.11927013, 0.12743462, 0.12499852, 0.14239237,
    #            0.14642067, 0.15102582, 0.13979497, 0.14720234, 0.14768832,
    #            0.14920138, 0.14537345, 0.15917719, 0.16166228, 0.16469922,
    #            0.15738108, 0.16615155, 0.16689954, 0.16809375, 0.16035303,
    #            0.16180442, 0.16156603, 0.16229368, 0.15858225, 0.15944802,
    #            0.15682213, 0.15487311, 0.14935028, 0.15003284, 0.14520083,
    #            0.14099893, 0.13020642, 0.12659815, 0.12118042, 0.11778188,
    #            0.10906845, 0.11034748, 0.10929555, 0.10990388, 0.10366387,
    #            0.1072789 , 0.1123482 , 0.118648  , 0.1216675 , 0.1323918 ,
    #            0.13166999, 0.13166448, 0.12404023, 0.127656  , 0.12613648,
    #            0.12675283, 0.12793529, 0.1450178 , 0.14441326, 0.14654921,
    #            0.14042744, 0.15270501, 0.15355766, 0.15587266, 0.14600275,
    #            0.1475432 , 0.14328498, 0.14054154, 0.12789275, 0.12633816,
    #            0.1206938 , 0.11655481, 0.10423051, 0.10707333, 0.10097102,
    #            0.09628118, 0.0826384 , 0.08346074, 0.07919732, 0.07671491,
    #            0.06754267, 0.07213576, 0.07078757, 0.0718717 , 0.06807092,
    #            0.07508523, 0.07918163, 0.0847355 , 0.08616458, 0.09256395,
    #            0.09372961, 0.09555098, 0.0909166 , 0.09393036, 0.09262082,
    #            0.09198445, 0.08655168, 0.09117272, 0.09039606, 0.09026641,
    #            0.08523228, 0.09013029, 0.08968328, 0.0896126 , 0.08552485,
    #            0.08955143, 0.08837146, 0.08764309, 0.08217987, 0.08205565,
    #            0.08063646, 0.07992265, 0.07962358, 0.08339898, 0.08462298,
    #            0.08663278, 0.08536715, 0.09119921, 0.09048512, 0.09063731,
    #            0.0869831 ]
    #     ti7 = [0.07070059, 0.07582017, 0.0749104 , 0.07473857, 0.06808778,
    #            0.06844276, 0.06698857, 0.06655368, 0.06359654, 0.06426313,
    #            0.06371077, 0.06415845, 0.06392195, 0.06903203, 0.06829119,
    #            0.06856154, 0.06470861, 0.06848835, 0.06776557, 0.06805828,
    #            0.06446554, 0.06643126, 0.06587744, 0.06650365, 0.06457294,
    #            0.06829984, 0.06837395, 0.06911542, 0.06581558, 0.06627073,
    #            0.06672641, 0.06835702, 0.06706536, 0.06754318, 0.07013879,
    #            0.07375702, 0.07579953, 0.08104936, 0.08557737, 0.09088146,
    #            0.09302153, 0.1026353 , 0.10431326, 0.10692729, 0.10512942,
    #            0.1100988 , 0.11134879, 0.11343701, 0.1153725 , 0.12408631,
    #            0.12557982, 0.12774046, 0.12561049, 0.1321726 , 0.13340538,
    #            0.13520256, 0.13214277, 0.1340838 , 0.13488271, 0.13693747,
    #            0.13698341, 0.14089922, 0.14047885, 0.14090924, 0.13666769,
    #            0.13505546, 0.13536246, 0.13667817, 0.13945305, 0.14330738,
    #            0.14870242, 0.15513891, 0.16405056, 0.17785946, 0.18160312,
    #            0.18631355, 0.17819048, 0.1754533 , 0.17384586, 0.17324166,
    #            0.17248688, 0.17656491, 0.17547052, 0.17542588, 0.1710877 ,
    #            0.17266366, 0.16932964, 0.16793205, 0.16391019, 0.16936093,
    #            0.16991228, 0.17176881, 0.16795387, 0.17262856, 0.1692405 ,
    #            0.16685997, 0.15780036, 0.16121523, 0.15939771, 0.15892265,
    #            0.15494587, 0.15929658, 0.16269198, 0.16731372, 0.1724758 ,
    #            0.18273788, 0.18406189, 0.18624499, 0.1783689 , 0.18062264,
    #            0.17641174, 0.17372971, 0.16432775, 0.16709713, 0.16129423,
    #            0.15699762, 0.14104224, 0.14160937, 0.13434641, 0.12836182,
    #            0.11457502, 0.11519132, 0.10971666, 0.10599994, 0.09607775,
    #            0.09748966, 0.09413284, 0.09233045, 0.08474541, 0.08724957,
    #            0.08659626, 0.08769754, 0.0860593 , 0.09092731, 0.08924928,
    #            0.0883884 , 0.08404001, 0.08697857, 0.08534519, 0.08476076,
    #            0.08341272, 0.08877758, 0.08790355, 0.08812211, 0.08189265,
    #            0.08266675, 0.07992106, 0.07807761, 0.07187111, 0.07563409,
    #            0.07353781, 0.07233719, 0.0659536 , 0.068879  , 0.06860747,
    #            0.06940955, 0.06625946, 0.06939224, 0.06896779, 0.06933481,
    #            0.06418534]
        ti10 = [0.06066846, 0.05983486, 0.05978876, 0.06053549, 0.06057468,
               0.05968417, 0.05958152, 0.06027875, 0.06042332, 0.05915841,
               0.05900459, 0.05998595, 0.06269798, 0.05997043, 0.05820869,
               0.05751108, 0.0584497 , 0.0567061 , 0.05644548, 0.05768351,
               0.05917586, 0.0589986 , 0.06003882, 0.06223349, 0.06435511,
               0.06376804, 0.06406031, 0.06522072, 0.06608993, 0.06427376,
               0.06337064, 0.06341236, 0.06419568, 0.06494162, 0.0666378 ,
               0.06921287, 0.07211539, 0.07410505, 0.07676319, 0.08002303,
               0.081918  , 0.08201152, 0.08319223, 0.08542301, 0.08688746,
               0.08553058, 0.08527084, 0.08615224, 0.08795473, 0.08558528,
               0.08534172, 0.08732317, 0.0919872 , 0.09199653, 0.09349858,
               0.09647671, 0.10194999, 0.10287935, 0.10490053, 0.10799714,
               0.11257047, 0.11182281, 0.11289393, 0.11580776, 0.11896696,
               0.11867184, 0.11982186, 0.12243754, 0.12558123, 0.12289446,
               0.12144955, 0.12133429, 0.12179885, 0.1204528 , 0.12078538,
               0.12282283, 0.1259775 , 0.12660569, 0.12842282, 0.13141047,
               0.1354793 , 0.1341075 , 0.13368858, 0.13425153, 0.13522936,
               0.13175434, 0.12960096, 0.12885275, 0.12965236, 0.1268545 ,
               0.12599984, 0.12712214, 0.1312178 , 0.12894357, 0.12771281,
               0.12755311, 0.12999209, 0.12483415, 0.12129076, 0.11950241,
               0.11970155, 0.1181047 , 0.11832543, 0.12034048, 0.12302221,
               0.12333907, 0.12487911, 0.12758531, 0.12965798, 0.12728713,
               0.12590087, 0.1255255 , 0.1248022 , 0.11989503, 0.11641777,
               0.11445722, 0.11464184, 0.11138039, 0.10972279, 0.10969123,
               0.11273258, 0.11155751, 0.11158189, 0.11279824, 0.11559987,
               0.11283734, 0.11112645, 0.1104963 , 0.11130123, 0.10828813,
               0.10658427, 0.10620594, 0.10628611, 0.10452728, 0.1037507 ,
               0.10397071, 0.1041172 , 0.10103084, 0.0989076 , 0.09782363,
               0.09821368, 0.09431972, 0.09167607, 0.09040388, 0.09024181,
               0.08901065, 0.08894104, 0.09003204, 0.09226253, 0.09434752,
               0.09745655, 0.10148887, 0.10619393, 0.10559443, 0.10561593,
               0.10625299, 0.10881093, 0.10295937, 0.09775426, 0.09328684,
               0.09270436]


            ti4 = [       0.0,        0.0,        0.0,        0.0,        0.0,
           0.0768378 , 0.07692252, 0.07655719, 0.07575242, 0.07506204,
           0.07465602, 0.074067  , 0.07337768, 0.07309346, 0.07324877,
           0.07328735, 0.0732017 , 0.07343398, 0.07404865, 0.07447646,
           0.07469461, 0.07508668, 0.07565621, 0.07592181, 0.07594494,
           0.07613082, 0.07645608, 0.07646068, 0.07607487, 0.07575285,
           0.07554397, 0.07509445, 0.07445339, 0.07409358, 0.07400736,
           0.07384824, 0.07374177, 0.07442538, 0.07591291, 0.0777586 ,
           0.07997896, 0.08352427, 0.08812292, 0.09315732, 0.09843067,
           0.10470702, 0.11134245, 0.11741748, 0.12250756, 0.12758606,
           0.13260814, 0.13686881, 0.14037986, 0.14404409, 0.14764927,
           0.15025293, 0.15191392, 0.1537727 , 0.15621875, 0.15825219,
           0.15980762, 0.16167009, 0.16380304, 0.16531811, 0.16611213,
           0.16676511, 0.16736203, 0.1671638 , 0.16616545, 0.16503902,
           0.16386609, 0.16192643, 0.15914849, 0.1562707 , 0.1532246 ,
           0.14910872, 0.14394183, 0.13861465, 0.13380339, 0.12855662,
           0.12329574, 0.11910391, 0.11655901, 0.11453489, 0.11321917,
           0.11366295, 0.11552827, 0.11742421, 0.11881826, 0.12073553,
           0.12293066, 0.12463958, 0.12593536, 0.12806059, 0.13063565,
           0.13282088, 0.13488498, 0.13844045, 0.14316026, 0.1476666 ,
           0.15135522, 0.15533615, 0.15881417, 0.16050265, 0.16037175,
           0.15942821, 0.1576753 , 0.15391954, 0.14842251, 0.14248448,
           0.13664143, 0.12964391, 0.12188976, 0.11475821, 0.10889349,
           0.10305407, 0.09726296, 0.09244415, 0.08874422, 0.08484933,
           0.08124917, 0.07892991, 0.07828857, 0.07792437, 0.07796736,
           0.07901869, 0.08102685, 0.08295363, 0.08463121, 0.08648551,
           0.08834075, 0.0895592 , 0.09009639, 0.09042318, 0.09061726,
           0.09030721, 0.08965779, 0.08920927, 0.08906869, 0.08875948,
           0.08829981, 0.08817162, 0.08828647, 0.08808242, 0.0874828 ,
           0.08699598, 0.08669455, 0.08614057, 0.08542477, 0.08512609,
           0.08516244, 0.08503982, 0.08474885, 0.08501028, 0.08573591,
           0.08635707, 0.08663689, 0.08702348, 0.08767904, 0.08802521,
           0.08825361]
            ti7 = [       0.0,        0.0,        0.0,        0.0,        0.0,
           0.06876226, 0.06844174, 0.06803451, 0.06761853, 0.06742821,
           0.06745529, 0.06742803, 0.06736328, 0.06748157, 0.06779654,
           0.06797016, 0.0679803 , 0.06800659, 0.06808986, 0.06802991,
           0.06794891, 0.06803018, 0.06824287, 0.06835542, 0.06835268,
           0.06844403, 0.0687426 , 0.06904107, 0.06938001, 0.0700384 ,
           0.07092141, 0.07181729, 0.07272601, 0.07415884, 0.07607704,
           0.07828228, 0.0806002 , 0.08350207, 0.08660455, 0.08972785,
           0.09266994, 0.09581722, 0.09920386, 0.10252379, 0.10580322,
           0.10924121, 0.11263457, 0.11569069, 0.11842609, 0.12114317,
           0.12393678, 0.12656757, 0.12896602, 0.13147753, 0.13395979,
           0.13624305, 0.13823273, 0.14026566, 0.14208894, 0.1433891 ,
           0.14401876, 0.14432304, 0.14466888, 0.14479003, 0.14481012,
           0.14513191, 0.14612567, 0.14740262, 0.14941871, 0.15246788,
           0.1562608 , 0.16034511, 0.16384739, 0.16712238, 0.17001654,
           0.1722174 , 0.17368034, 0.17485837, 0.17548493, 0.17538942,
           0.17474902, 0.1738243 , 0.17296978, 0.17199329, 0.17086067,
           0.1700728 , 0.16951837, 0.16883631, 0.16802878, 0.16725611,
           0.16654193, 0.16567404, 0.16455807, 0.16359543, 0.16282818,
           0.16180968, 0.16061794, 0.15978155, 0.1594676 , 0.15953774,
           0.16019186, 0.16177029, 0.16407811, 0.16660372, 0.16885475,
           0.17110969, 0.17308261, 0.17422378, 0.17433698, 0.17371156,
           0.17221469, 0.16946856, 0.16572926, 0.16145337, 0.15697462,
           0.15192978, 0.14642892, 0.14084943, 0.13528036, 0.12942664,
           0.12346104, 0.1179405 , 0.11316737, 0.10864457, 0.1043648 ,
           0.10100211, 0.09857743, 0.09646143, 0.09451319, 0.09308348,
           0.09210822, 0.09097192, 0.08973473, 0.08874007, 0.08824029,
           0.08758284, 0.08697273, 0.08659468, 0.08648381, 0.0862225 ,
           0.08575779, 0.08525142, 0.08489597, 0.08426659, 0.08333145,
           0.08231153, 0.08114273, 0.07949883, 0.07760512, 0.07571293,
           0.07417101, 0.07277023, 0.07151189, 0.0706528 , 0.07014811,
           0.06965092, 0.0690344 , 0.06877065, 0.06882099, 0.06872793,
           0.06871569]
            ti10 = [       0.0,        0.0,        0.0,        0.0,        0.0,
           0.06241355, 0.06242298, 0.06259945, 0.06300088, 0.06314635,
           0.06309325, 0.06307886, 0.06314322, 0.06295614, 0.06258713,
           0.0623755 , 0.06233499, 0.06206534, 0.06157884, 0.06143498,
           0.06164462, 0.06181397, 0.06191926, 0.06230513, 0.06291234,
           0.06338861, 0.06368896, 0.06415946, 0.06472236, 0.0652809 ,
           0.06583016, 0.06672064, 0.06792222, 0.06914212, 0.07038837,
           0.0719224 , 0.07370235, 0.07542485, 0.0771472 , 0.07891871,
           0.08071577, 0.08217436, 0.08339844, 0.08468488, 0.08609426,
           0.08713377, 0.08796092, 0.08897716, 0.09027107, 0.09126875,
           0.09204887, 0.09316097, 0.0946515 , 0.09619029, 0.09776384,
           0.09990614, 0.10250723, 0.10490015, 0.10703956, 0.1095155 ,
           0.11226892, 0.11462085, 0.11656596, 0.11856163, 0.12063183,
           0.12207941, 0.12291529, 0.12373068, 0.12449631, 0.12483403,
           0.12474781, 0.12490566, 0.12530376, 0.12559526, 0.1257472 ,
           0.12642053, 0.12760916, 0.12865114, 0.1295541 , 0.13062539,
           0.1318387 , 0.13260562, 0.13296029, 0.13322806, 0.13347615,
           0.13310161, 0.13222587, 0.13158612, 0.13129486, 0.13068116,
           0.12978219, 0.12919314, 0.12891736, 0.12827434, 0.1272475 ,
           0.12651558, 0.12604588, 0.12538403, 0.12445951, 0.12402549,
           0.12407491, 0.12407033, 0.12398229, 0.12446115, 0.12541796,
           0.12620172, 0.12671001, 0.12725038, 0.12778295, 0.12771839,
           0.12706738, 0.12633331, 0.12557135, 0.12430481, 0.12261338,
           0.12115426, 0.12001808, 0.11865167, 0.11708469, 0.11604594,
           0.11558531, 0.11505132, 0.11438526, 0.11407524, 0.11406136,
           0.11377146, 0.11313469, 0.11259207, 0.11210021, 0.11125348,
           0.10998318, 0.10893071, 0.1080917 , 0.10696517, 0.10556114,
           0.10445974, 0.10367595, 0.10271352, 0.10157073, 0.10054037,
           0.0996506 , 0.09866066, 0.09756217, 0.09685668, 0.09653777,
           0.09637762, 0.09636047, 0.09700602, 0.09828682, 0.09951859,
           0.10067648, 0.10199343, 0.10345159, 0.10428213, 0.10452628,
           0.10441708, 0.10397599, 0.10396991, 0.10344355, 0.10293194,
           0.10227865]
    end

    if k == 1
        subplot(131)
    elseif k == 2
        subplot(132)
    elseif k == 3
        subplot(133)
    end


    x_TI = range(-200.0/rotor_diameter[1],stop=200.0/rotor_diameter[1],length=length(ti4))
    if sep == 4.0
           plot(x_TI,ti4)
           title("4 D",fontsize=10)
           ylabel("TI")
    elseif sep == 7.0
           plot(x_TI,ti7)
           title("7 D",fontsize=10)

           tick_params(
               axis="y",          # changes apply to the x-axis
               which="both",      # both major and minor ticks are affected
               left=false,      # ticks along the bottom edge are off
               top=false,         # ticks along the top edge are off
               labelleft=false) # labels along the bottom edge are off

    elseif sep == 10.0
           plot(x_TI,ti10,label="SOWFA")
           title("10 D",fontsize=10)

           tick_params(
               axis="y",          # changes apply to the x-axis
               which="both",      # both major and minor ticks are affected
               left=false,      # ticks along the bottom edge are off
               top=false,         # ticks along the top edge are off
               labelleft=false) # labels along the bottom edge are off

    end

    if k == 3
        plot(y_vec./rotor_diameter[1],TI,label="TI model")
        legend(loc=1)
    else
        plot(y_vec./rotor_diameter[1],TI)
    end

    ylim(0.0,0.225)
    xlabel("offset (D)")

end

subplots_adjust(top=0.91,bottom=0.18,left=0.11,right=0.99,wspace=0.05)
savefig("turbulence_profiles.pdf",transparent=true)



# plot((z_vec.-turbine_x[1])./rotor_diameter,TI.-ambient_ti)

# figure(2)
# for i = 1:length(turbine_x)
#     plt.gcf().gca().add_artist(plt.Circle((turbine_x[i],turbine_y[i]), rotor_diameter/2.0, fill=false,color="C1"))
# end
#
# plot([-1000.0,1000.0],[0.0,0.0])
# # plot([0.0,0.0],[-1000.0,1000.0])
# axis("square")
# xlim(minimum(turbine_x)-200,maximum(turbine_x)+200)
# ylim(minimum(turbine_y)-200,maximum(turbine_y)+200)

# axis("square")
# xlim(-boundary_radius-200,boundary_radius+200)
# ylim(-boundary_radius-200,boundary_radius+200)







# using PyPlot
# using NPZ
#
# u = npzread("ub_hist4.npy")
# using Statistics
# println(std(u)/mean(u))
# # plot(u[6000:end])
# # hist(u[20000:end],bins=50)
# hist(u,bins=20)
# plot([mean(u),mean(u)],[0.0,300.0])
# xlabel("wind speed (m/s")
# title("4")
