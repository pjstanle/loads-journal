using FLOWMath
using Geodesy
using FlowFarm
const ff = FlowFarm
using CCBlade
using PyPlot
using Random
using Statistics
include("coeffs_data.jl")
include("TIcoeffs_data.jl")

wind_speed = 10.
include("model.jl")


Nlocs = 50
# az_arr = [0.0,pi/2,pi,3*pi/2]
az_arr = [pi/2,3*pi/2]
naz = length(az_arr)
nCycles = 50

# #100 samples old
# turb_samples = [-1.7375742815948083, -1.135389245536721, 0.2630500661591889, -0.3053490870899974, 0.45122718486129615, 1.3409656986041674, -0.5962815531229234,
#                 -0.8493480555694776, 0.6848369957940627, -0.7771766418857682, 0.8517520073813781, -1.55121204574954, 0.9905046860451119, -0.4608656968037635,
#                 0.7587262485526834, -1.3704467034953913, -0.831452989259264, -0.056209344897895024, -0.3826758972800919, -0.1160034988857537, 0.8934058398493318,
#                 0.1232662269472102, -1.4259490734091038, 0.08730632432141205, 0.220114136790133, -0.21512941735364838, -0.27219450738624384, 0.1362571602997146,
#                 1.9738755600156555, 0.30585725550110954, 1.1582850981501636, 0.09420837912360198, 0.9228288367395507, 0.17538955539546192, -0.40412325658363457,
#                 3.780851032410102, -0.26388716275783936, -0.020801732384506465, -0.1336549155203504, 0.2906739135354345, 2.1312061518785486, -0.9002466925300798,
#                 0.45720257310523066, -1.7505057790094762, 1.4066197735539343, -0.32494821468167184, -0.6966259079423474, -2.078912472251868, 0.9135061026036851,
#                 0.3910927643533145, -0.09807936478061946, -0.5608043316451404, 0.8652341644152277, 0.7319576001136265, 0.7820837886706138, 0.3427756118883895,
#                 -2.2205214713373165, 0.29795270622313863, 0.5265642785081389, -0.14787685963244643, 1.5619455649553944, 0.511198972073372, 0.7084023961683763,
#                 -0.861279192574816, 0.02378123660375562, -0.6341896458879221, -0.4807288677229144, -0.23810513426345103, 1.2816747716663464, -0.7683218197813537,
#                 -0.3683566101504853, 0.49965767793724625, 0.0030265593973706787, -0.5988579341843617, -0.006944347541253066, 0.04029979208606582, 0.9945395908678365,
#                 0.15698510625217518, -1.2831768394685863, 1.0937721306552926, 0.6613475137268306, -0.44696767128359516, -0.8174140757469877, -1.892303711911644,
#                 -1.109804250710215, -0.6617193128709387, -0.7525044828419295, 0.40917572096199556, -0.20236450637456538, -0.17354382607159158, -0.24140283227854467,
#                 1.7087073735018894, 0.36734209684815883, -0.19854734466460922, 0.10184933942978404, 0.6243982847899877, 1.7665493511011094, -0.06938898370740094,
#                 -1.9715641041839593, -0.03368414989920392, 0.4290617964907311, 0.05159819743922302, -0.30982117770939815, 1.647604210905681, -1.214982899348507,
#                 -2.972245699310368, 0.9567406980673966, -0.9244077825804254, 1.273462174748022, 0.4149364508895135, -1.622897424445604, -1.096072395892489,
#                 -1.67722652069405, -1.2440103207394082, -0.3347907992149652, 0.34937500503899444, -1.3956454864454866, -1.8320556682799327, -2.4525716814873615,
#                 1.3158932565438999, 1.0424619550935403, 0.4728613776179114, -0.7993384668244552, 0.8047775976047779, -1.328993822674748, -0.5517542856280235,
#                 -0.08570570820963805, -1.2601172953695525, 0.6984883764673556, 1.1079418349876193, -0.5230949927376777, 0.743324533508432, -0.35741280746085,
#                 -0.6433547716879965, -0.6248070396487141, -0.975403850134493, 0.06493134905461244, -0.5758050662378422, 0.20171094486367738, -0.10593462776252129,
#                 -0.5370144822605072, -0.6853253756977159, -1.4465071106549015, 0.5593089566251558, 1.1803860182434085, 1.8281801860593134, 0.1393077475121944,
#                 -0.04181026365029896, 2.300744813553216, 0.5511941888031783, 0.9465601848529518, 1.3755595718496274, -1.1515666852841093, 0.37779029430817546,
#                 -0.7292803100887157, -0.16170208773955125, 0.18900362617828753, 1.1448438474771956, 0.8271738491766991, 1.2115257481247956, -1.191875436470305,
#                 1.4486548549389235, 0.49348318462552093, 0.26649753996923525, 2.4724547704542985, 0.6582994207353369, -0.8941392219184868, -0.4946969515871099,
#                 0.8080550523143554, 1.9472346620863374, 0.6014829477177043, 0.23191241572415017, -0.9677362878826911, 0.6417690472085171, -1.0490254136322847,
#                 0.034259889192891274, -0.7168792601975139, -1.0705626259281662, 0.5815176572837153, 0.5875960488417961, -0.17820054924711645, -0.9990232414477314,
#                 -0.49625310409382234, 1.0645229366516777, -1.5098752131050561, -0.42153252496880467, -0.3886937922943286, 1.026133272436106, -0.42822963485113064,
#                 -0.9346168372838812, -1.0186171457999047, 0.3275533703067123, 1.2486394902352276, 1.4985382411755432, 0.20336081436602027, 1.6052127564433083,
#                 -0.2832107440916983, -1.596145704023063, 1.536103270856809, 0.2479806262327784]


# turb_samples = [ 1.15642461,  0.89194786,  0.3258023 , -0.00685987,  0.40845129,  1.16262328,  1.43123249,  0.88988163,  0.18529903, -0.26720417,
#        -0.08124395,  0.40638506,  0.15223943, -0.61432991, -0.54407827,   0.44770956,  0.97046439,  1.0799743 ,  1.61306026,  1.5324775 ,
#         0.86302071,  0.91467633,  1.37131197,  1.30932523,  0.98492796,   0.77210683,  0.83202734,  0.73698101,  0.35679567,  0.63366977,
#         1.5407424 ,  1.48082188,  0.38985527, -0.42630347, -0.6639193 ,  -0.8478133 , -1.03170729, -1.02550862, -0.9655881 , -0.87674044,
#        -0.38911143,  0.29067648,  0.31340495, -0.32092601, -0.91806494,  -0.77962788,  0.43531221,  1.5407424 ,  1.30519279,  0.42498109,
#         0.15223943,  0.16050433, -0.12256845, -0.57507164, -1.00071392,  -0.9655881 , -0.3870452 ,  0.46423935,  1.33618616,  1.52008015,
#         0.77210683, -0.09157508, -0.39944255, -0.32092601,  0.40431884,   1.41263647,  1.69777547,  1.21634513,  0.34646455, -0.15356182,
#        -0.64325706, -1.46148202, -1.81274021, -1.50900518, -1.06889933,  -0.60399879, -0.01925721,  0.24315332,  0.47457048,  0.7865704 ,
#         0.51589497,  0.03446463, -0.32092601, -0.52754848, -0.57093919,  -0.37258163, -0.30026377, -0.82095238, -1.37263436, -1.47181314,
#        -1.32097874, -0.91393249, -0.33745581,  0.13157719,  0.22249107,  -0.13909824, -0.70937625, -0.90153514, -0.59160144, -0.52548225,
#        -0.81888615, -1.01517749, -1.07923046, -1.12262118, -1.03170729,  -0.87467422, -1.01930994, -1.44908467, -1.6949654 , -1.46561447,
#        -0.82508483, -0.25067437, -0.28580019, -0.98005167, -1.46561447,  -0.93459473,  0.29274271,  0.58614661,  0.49936517,  1.60066291,
#         1.2308087 , -0.96765433, -2.22391891, -2.06275339, -1.35197211,  -1.06270066, -1.4346211 , -1.60611774, -1.44495222, -1.66397203,
#        -2.24251493, -2.52145526, -2.27144208, -1.73215745, -1.00278015,  -0.20728366, -0.01512476, -0.80442258, -1.60611774, -1.66190581,
#        -1.09369403, -0.38291275,  0.41051751,  1.3485835 ,  1.60892781,   0.64193467,  0.13570963,  0.59854396,  0.6605307 ,  0.47870293,
#         1.19361665,  2.01597406,  1.73290129,  0.96219949,  0.15637188,   0.0406633 ,  0.39192149,  0.05925932, -0.63292593, -0.8064888 ,
#        -0.71557492, -0.71970737, -0.49242266, -0.19901876, -0.53374715,  -1.13708475, -0.9655881 ,  0.065458  ,  0.86095449,  0.96426572,
#         0.86921938,  0.56755059, -0.13496579, -0.20934988,  0.69152407,   1.08617297,  0.44977578,  0.16257056,  0.75764325,  1.2225438 ,
#         1.24320605,  1.65645098,  2.20606673,  1.776292  ,  0.90641143,   0.68119294,  0.86095449,  0.90227898,  0.73491478,  0.55721946,
#         0.30927251, -0.07917773,  0.10884871,  0.86302071,  1.17088818,   1.12956369,  1.25353717,  1.0965041 ,  0.72251743,  0.82582867]

turb_samples_low = [ 9.91804332e-01,  9.08836831e-01,  8.35488750e-01,  7.81379510e-01,        7.41699401e-01,  7.09233857e-01,  6.68351320e-01,  6.01015377e-01,
        4.95201752e-01,  3.68946859e-01,  2.46299248e-01,  1.46497761e-01,        6.47326874e-02, -5.00811076e-03, -6.75343436e-02, -1.15631446e-01,
       -1.40882424e-01, -1.48096990e-01, -1.61323693e-01, -2.08218367e-01,       -2.93590724e-01, -3.94594638e-01, -4.75157285e-01, -5.10027684e-01,
       -4.96800981e-01, -4.61930581e-01, -4.31869893e-01, -4.25857755e-01,       -4.40286885e-01, -4.55918444e-01, -4.40286885e-01, -3.68141232e-01,
       -2.39481484e-01, -8.31659018e-02,  5.03035567e-02,  1.14032217e-01,        9.35909487e-02,  5.81373723e-03, -1.18036301e-01, -2.43088767e-01,
       -3.56116957e-01, -4.47501451e-01, -5.06420401e-01, -5.30468952e-01,       -5.35278662e-01, -5.46100510e-01, -5.85780620e-01, -6.56723845e-01,
       -7.38488919e-01, -7.97407869e-01, -7.97407869e-01, -7.15642795e-01,       -5.48505365e-01, -3.03210144e-01, -1.82348139e-02,  2.88384213e-01,
        5.96205666e-01,  8.79978569e-01,  1.09761796e+00,  1.19862187e+00,        1.16615633e+00,  1.04110386e+00,  9.00419838e-01,  8.21059619e-01,
        8.48715453e-01,  9.82184911e-01,  1.15653691e+00,  1.27798209e+00,        1.27196995e+00,  1.13128593e+00,  9.06431976e-01,  6.63541610e-01,
        4.56724070e-01,  3.08825481e-01,  2.25857980e-01,  1.96999718e-01,        2.01809429e-01,  2.13833704e-01,  1.93392436e-01,  1.10424934e-01,
       -3.62712272e-02, -2.09420795e-01, -3.45295109e-01, -3.93392211e-01,       -3.56116957e-01, -2.97198006e-01, -2.85173731e-01, -3.48902391e-01,
       -4.61930581e-01, -5.73756344e-01, -6.43497142e-01, -6.65140838e-01,       -6.59128700e-01, -6.51914135e-01, -6.51914135e-01, -6.48306852e-01,
       -6.24258301e-01, -5.70149061e-01, -4.85979133e-01, -3.95797066e-01,       -3.24853840e-01, -2.91185869e-01, -3.09222282e-01, -3.71748515e-01,
       -4.70347574e-01, -5.85780620e-01, -7.00011237e-01, -7.92598159e-01,       -8.50314682e-01, -8.68351095e-01, -8.53921964e-01, -8.17849138e-01,
       -7.73359318e-01, -7.27667071e-01, -6.81974824e-01, -6.30270439e-01,       -5.67744206e-01, -4.90788843e-01, -4.10226197e-01, -3.45295109e-01,
       -3.16436847e-01, -3.30865978e-01, -3.81367935e-01, -4.43894168e-01,       -4.93193698e-01, -5.20849532e-01, -5.43695655e-01, -5.86983047e-01,
       -6.69950548e-01, -7.85383594e-01, -9.12840914e-01, -1.03188124e+00,       -1.12927787e+00, -1.20503081e+00, -1.26154491e+00, -1.30723715e+00,
       -1.35172697e+00, -1.40102650e+00, -1.45152846e+00, -1.49361342e+00,       -1.50684013e+00, -1.46475516e+00, -1.34571483e+00, -1.12807545e+00,
       -8.22658848e-01, -4.53513589e-01, -8.31659018e-02,  2.04214284e-01,        3.35278887e-01,  2.94396350e-01,  1.48902616e-01,  1.66355852e-02,
        2.02428679e-02,  2.37882255e-01,  6.56327044e-01,  1.16134662e+00,        1.56656470e+00,  1.73490456e+00,  1.66636619e+00,  1.47998992e+00,
        1.28760151e+00,  1.13609564e+00,  1.02426988e+00,  9.34087809e-01,        8.52322736e-01,  7.69355234e-01,  6.89995016e-01,  6.29873638e-01,
        6.11837225e-01,  6.46707624e-01,  7.28472697e-01,  8.43905743e-01,        9.83387339e-01,  1.14090535e+00,  1.29962579e+00,  1.44030981e+00,
        1.52928945e+00,  1.53650401e+00,  1.44872680e+00,  1.28279180e+00,        1.08318883e+00,  9.10039258e-01,  8.29476612e-01,  8.89597990e-01,
        1.11565437e+00,  1.47758506e+00,  1.87438616e+00,  2.18220761e+00,        2.32649892e+00,  2.33852319e+00,  2.26637754e+00,  2.17018334e+00,
        2.00304591e+00,  1.74572641e+00,  1.43069039e+00,  1.14932234e+00,        9.97816470e-01,  1.01585288e+00,  1.15653691e+00,  1.30323307e+00,
        1.32848405e+00,  1.16014419e+00,  8.25869329e-01,  4.23056099e-01,        1.00805514e-01, -6.03197783e-02, -4.10809374e-02,  1.08020079e-01,
        2.91991495e-01,  4.14639106e-01,  4.24258526e-01,  3.46100735e-01,        2.55918669e-01,  2.27060407e-01,  2.83574502e-01,  3.86983272e-01,
        4.65141063e-01,  4.62736208e-01,  3.68946859e-01,  2.28262835e-01,        9.96030865e-02,  2.38501505e-02,  1.78380128e-02,  8.51739558e-02,
        2.25857980e-01,  4.37485229e-01,  6.99614436e-01,  9.74970346e-01,        1.21184857e+00,  1.35854474e+00,  1.38620057e+00,  1.30563792e+00,
        1.15773933e+00,  9.82184911e-01,  8.33083895e-01,  7.46509111e-01,        7.62140669e-01,  9.02824693e-01,  1.14691749e+00,  1.42588068e+00,
        1.66275891e+00,  1.83711090e+00,  2.00184348e+00,  2.18220761e+00,        2.33852319e+00,  2.33852319e+00,  2.13411051e+00,  1.77217981e+00,
        1.37056901e+00,  1.05312814e+00,  8.67954294e-01,  8.15047481e-01,        8.57132446e-01,  9.38897519e-01,  1.00984075e+00,  1.03869901e+00,
        1.00743589e+00,  9.10039258e-01,  7.51318821e-01,  5.64942550e-01,        4.18246388e-01,  3.78566279e-01,  4.71153201e-01,  6.68351320e-01,
        8.59537301e-01,  9.36492664e-01,  8.31881467e-01,  5.57727985e-01,        1.96999718e-01, -1.51704272e-01, -4.16238334e-01, -5.67744206e-01,
       -6.09829171e-01, -5.70149061e-01, -4.75157285e-01, -3.58521812e-01,       -2.39481484e-01, -1.28858149e-01, -1.94372414e-02,  9.59958038e-02,
        2.21048269e-01,  3.32874032e-01,  4.05019685e-01,  4.21853671e-01,        3.89388127e-01,  3.22052184e-01,  2.39084683e-01,  1.60926892e-01,
        1.05615224e-01,  8.87812385e-02,  1.17639500e-01,  1.87380298e-01,        2.82372075e-01,  3.78566279e-01,  4.36282802e-01,  4.35080374e-01,
        3.86983272e-01,  3.20849756e-01,  2.65538089e-01,  2.27060407e-01,        2.01809429e-01,  1.78963305e-01,  1.46497761e-01,  8.99836660e-02,
       -3.80568321e-03, -1.28858149e-01, -2.63530035e-01, -3.78963080e-01,       -4.41489313e-01, -4.37882030e-01, -3.74153370e-01, -2.76756738e-01,
       -1.79360106e-01, -1.13226591e-01, -8.79756120e-02, -8.67731845e-02,       -8.43683294e-02, -6.63319160e-02, -4.22833650e-02, -4.34857925e-02,
       -9.87974600e-02, -2.14230505e-01, -3.77760653e-01, -5.42493228e-01,       -6.80772396e-01, -7.74561746e-01, -8.32278268e-01, -8.77970515e-01,
       -9.39294321e-01, -1.03909581e+00, -1.18218469e+00, -1.35172697e+00,       -1.51886440e+00, -1.65113143e+00, -1.72327709e+00, -1.72327709e+00,
       -1.65473872e+00, -1.54411538e+00, -1.43950418e+00, -1.38178766e+00,       -1.39862165e+00, -1.49000614e+00, -1.63670230e+00, -1.80383973e+00,
       -1.95775046e+00, -2.06957622e+00, -2.12609032e+00, -2.12128061e+00,       -2.05995680e+00, -1.95414318e+00, -1.81947129e+00, -1.67397756e+00,
       -1.53329353e+00, -1.41906291e+00, -1.33729784e+00, -1.27837889e+00,       -1.22186480e+00, -1.12927787e+00, -9.54925879e-01, -6.57926273e-01,
       -2.29862063e-01,  2.75157509e-01,  7.30877553e-01,  9.91804332e-01,        9.85792194e-01,  7.69355234e-01,  4.80772621e-01,  2.31870117e-01,
        6.23278323e-02, -7.71537640e-02, -2.34671774e-01, -4.25857755e-01,       -6.33877722e-01, -8.29873413e-01, -9.87391423e-01, -1.09080019e+00,
       -1.14009972e+00, -1.14851672e+00, -1.14250458e+00, -1.15573128e+00,       -1.21705509e+00, -1.33128570e+00, -1.48519643e+00, -1.63670230e+00,
       -1.75814749e+00, -1.83149557e+00, -1.85915140e+00, -1.85313926e+00,       -1.82548343e+00, -1.78219604e+00, -1.72568194e+00, -1.65353629e+00,
       -1.56575908e+00, -1.47076730e+00, -1.38058523e+00, -1.30362987e+00,       -1.24471092e+00, -1.20142353e+00, -1.17016041e+00, -1.14490943e+00,
       -1.11965845e+00, -1.09080019e+00, -1.06554921e+00, -1.06073950e+00,       -1.09200262e+00, -1.14370700e+00, -1.17737498e+00, -1.14130215e+00,
       -1.01865454e+00, -8.46707399e-01, -6.95201527e-01, -6.35080149e-01,       -7.00011237e-01, -8.58731674e-01, -1.05592979e+00, -1.23028179e+00,
       -1.34451241e+00, -1.39381194e+00, -1.39982407e+00, -1.39982407e+00,       -1.43108719e+00, -1.51405469e+00, -1.64752415e+00, -1.80985187e+00,
       -1.96977473e+00, -2.09362477e+00, -2.16456800e+00, -2.18380684e+00,       -2.16456800e+00, -2.12609032e+00, -2.08881506e+00, -2.06596894e+00,
       -2.06957622e+00, -2.10564905e+00, -2.17178256e+00, -2.25955978e+00,       -2.35695641e+00, -2.44593605e+00, -2.51086713e+00, -2.53010598e+00,
       -2.48681858e+00, -2.37138554e+00, -2.17058014e+00, -1.89161694e+00,       -1.52728139e+00, -1.08478805e+00, -6.01412178e-01, -1.32465432e-01,
        2.78764792e-01,  6.01015377e-01,  8.17452336e-01,  9.59338788e-01,        1.08078397e+00,  1.18659760e+00,  1.18299031e+00,  9.80982484e-01,
        6.20254218e-01,  2.36679828e-01, -1.82348139e-02, -1.03607170e-01,       -4.46882201e-02,  9.35909487e-02,  2.33072545e-01,  3.11230336e-01,
        3.14837619e-01,  2.81169647e-01,  2.77562365e-01,  3.49708018e-01,        5.04821172e-01,  7.09233857e-01,  9.25670816e-01,  1.12767865e+00,
        1.30443550e+00,  1.42948796e+00,  1.47998992e+00,  1.42708311e+00,        1.26716024e+00,  1.03268687e+00,  8.03023206e-01,  6.65946465e-01,
        6.68351320e-01,  7.78974655e-01,  8.94407700e-01,  9.07634403e-01,        7.69355234e-01,  5.09630883e-01,  2.06619139e-01, -6.51294885e-02,
       -2.34671774e-01, -2.87578586e-01, -2.28659636e-01, -8.55707569e-02,        9.47933763e-02,  2.67942944e-01,  4.11031823e-01,  5.24060013e-01,
        6.19051790e-01,  6.98412009e-01,  7.53723676e-01,  7.75367372e-01,        7.60938241e-01,  7.27270270e-01,  6.92399871e-01,  6.63541610e-01,
        6.23861500e-01,  5.62537695e-01,  5.01213890e-01,  4.87987187e-01,        5.66144978e-01,  7.21258132e-01,  8.89597990e-01,  1.00382861e+00,
        1.02186502e+00,  9.58136360e-01,  8.60739728e-01,  7.92201358e-01,        7.97011068e-01,  8.76371287e-01,  9.78577629e-01,  1.04471114e+00,
        1.03629415e+00,  9.46112085e-01,  7.94606213e-01,  6.15444507e-01,        4.43497367e-01,  2.90789068e-01,  1.47700189e-01, -6.21053832e-03,
       -1.76955251e-01, -3.42890254e-01, -4.67942719e-01, -5.22051959e-01,       -4.99205836e-01, -4.31869893e-01, -3.71748515e-01, -3.63331522e-01,
       -4.23452900e-01, -5.24456814e-01, -6.17043736e-01, -6.57926273e-01,       -6.31472867e-01, -5.47302938e-01, -4.33072320e-01, -3.14031992e-01,
       -2.01003802e-01, -9.03804671e-02,  3.70768536e-02,  2.04214284e-01,        3.94197837e-01,  5.82978963e-01,  7.35687263e-01,  8.37893605e-01,
        9.06431976e-01,  9.70160636e-01,  1.05553299e+00,  1.15533448e+00,        1.23469470e+00,  1.23349227e+00,  1.10964223e+00,  8.69156721e-01,
        5.78169253e-01,  3.19647329e-01,  1.51307471e-01,  9.47933763e-02,        1.16437072e-01,  1.64534174e-01,  1.87380298e-01,  1.62129319e-01,
        8.99836660e-02,  2.20645456e-03, -6.63319160e-02, -8.19634742e-02,       -3.38663721e-02,  7.67569629e-02,  2.36679828e-01,  4.23056099e-01,
        6.07027514e-01,  7.52521249e-01,  8.18654764e-01,  8.06630488e-01,        7.51318821e-01,  7.12841139e-01,  7.35687263e-01,  8.23464474e-01,
        9.47314512e-01,  1.06875970e+00,  1.17216847e+00,  1.27798209e+00,        1.41024912e+00,  1.56776713e+00,  1.70604630e+00,  1.75775068e+00,
        1.66396133e+00,  1.42948796e+00,  1.12046408e+00,  8.40298460e-01,        6.68351320e-01,  6.32278493e-01,  7.04424146e-01,  8.34286322e-01]


turb_samples_high = [ 3.41739490e+00,  3.65949079e+00,  3.79506449e+00,  3.62075545e+00,        3.20435052e+00,  2.75889408e+00,  2.36185682e+00,  1.94545190e+00,
        1.56778231e+00,  1.43220861e+00,  1.53873080e+00,  1.72272368e+00,        1.80987820e+00,  1.82924587e+00,  1.96481957e+00,  2.12944477e+00,
        1.99387107e+00,  1.48062779e+00,  9.48016835e-01,  7.34972453e-01,        8.99597657e-01,  1.19011272e+00,  1.32568642e+00,  1.22884807e+00,
        9.96436012e-01,  7.25288617e-01,  4.44457386e-01,  1.82993826e-01,        8.68478651e-03, -9.99049034e-04,  1.05523142e-01,  2.60464511e-01,
        3.28251360e-01,  2.89516017e-01,  2.12045333e-01,  1.34574649e-01,       -3.00505557e-02, -3.10881787e-01, -6.01396853e-01, -7.36970551e-01,
       -6.98235208e-01, -5.62661511e-01, -4.27087813e-01, -3.98036306e-01,       -5.23926169e-01, -7.56338222e-01, -9.69382604e-01, -1.08558863e+00,
       -1.12432397e+00, -1.14369164e+00, -1.20857334e+00, -1.28313888e+00,       -1.30831685e+00, -1.22794101e+00, -1.05653712e+00, -8.43492742e-01,
       -6.88551373e-01, -6.01396853e-01, -5.43293840e-01, -4.17403978e-01,       -2.23727267e-01, -1.06828846e-02,  1.53942320e-01,  3.28251360e-01,
        5.80031084e-01,  8.12443137e-01,  8.80229986e-01,  7.83391630e-01,        6.86553275e-01,  7.34972453e-01,  8.51178479e-01,  8.99597657e-01,
        9.18965328e-01,  9.86752177e-01,  1.09327437e+00,  1.11264204e+00,        9.48016835e-01,  6.86553275e-01,  4.25089715e-01,  2.60464511e-01,
        1.73309991e-01,  1.44258484e-01,  1.63626155e-01,  2.02361497e-01,        2.41096840e-01,  2.79832182e-01,  2.50780675e-01,  1.05523142e-01,
       -1.84991924e-01, -5.14242333e-01, -7.36970551e-01, -7.75705893e-01,       -6.49816031e-01, -4.36771649e-01, -2.81830280e-01, -2.81830280e-01,
       -4.85190826e-01, -8.24125071e-01, -1.15337548e+00, -1.39353460e+00,       -1.53588698e+00, -1.64047241e+00, -1.72956369e+00, -1.79444539e+00,
       -1.83995942e+00, -1.89999920e+00, -1.99683756e+00, -2.11788550e+00,       -2.20891355e+00, -2.21859739e+00, -2.13531640e+00, -1.99199564e+00,
       -1.82640205e+00, -1.64918786e+00, -1.45551115e+00, -1.24053000e+00,       -1.03716945e+00, -8.82228084e-01, -8.04757399e-01, -7.75705893e-01,
       -7.66022057e-01, -7.46654386e-01, -7.56338222e-01, -8.62860413e-01,       -1.05653712e+00, -1.25215060e+00, -1.33349482e+00, -1.27151827e+00,
       -1.10495630e+00, -9.01595755e-01, -7.46654386e-01, -6.01396853e-01,       -3.39933293e-01,  1.53942320e-01,  7.93075466e-01,  1.28695108e+00,
        1.35473793e+00,  1.03517135e+00,  7.64023959e-01,  9.09281492e-01,        1.36442176e+00,  1.77114286e+00,  1.86798121e+00,  1.60651765e+00,
        1.15137738e+00,  6.76869439e-01,  2.12045333e-01, -2.33411102e-01,       -5.62661511e-01, -7.07919044e-01, -6.78867537e-01, -5.14242333e-01,
       -3.20565622e-01, -2.04359596e-01, -1.65624253e-01, -1.75308089e-01,       -2.33411102e-01, -3.39933293e-01, -4.56139320e-01, -5.52977675e-01,
       -6.30448360e-01, -6.78867537e-01, -7.07919044e-01, -7.07919044e-01,       -6.69183702e-01, -5.91713017e-01, -5.04558497e-01, -4.65823155e-01,
       -5.04558497e-01, -6.11080689e-01, -7.07919044e-01, -7.66022057e-01,       -8.14441235e-01, -9.20963426e-01, -1.06622096e+00, -1.13400781e+00,
       -1.02748562e+00, -8.33808906e-01, -7.85389728e-01, -1.02748562e+00,       -1.46035307e+00, -1.85545356e+00, -2.07043471e+00, -2.09270753e+00,
       -1.95132353e+00, -1.68792320e+00, -1.38288238e+00, -1.16983800e+00,       -1.12432397e+00, -1.19404759e+00, -1.26183444e+00, -1.25699252e+00,
       -1.17371153e+00, -1.05653712e+00, -9.69382604e-01, -9.30647262e-01,       -8.82228084e-01, -7.66022057e-01, -6.01396853e-01, -4.94874662e-01,
       -4.94874662e-01, -5.91713017e-01, -7.66022057e-01, -9.88750275e-01,       -1.17467992e+00, -1.27539181e+00, -1.24343515e+00, -1.06622096e+00,
       -7.85389728e-01, -5.04558497e-01, -3.10881787e-01, -1.94675760e-01,       -1.36572747e-01, -1.46256582e-01, -2.43094938e-01, -3.68984800e-01,
       -4.27087813e-01, -2.91514115e-01,  4.74201287e-02,  4.15405879e-01,        6.09082590e-01,  5.31611906e-01,  2.79832182e-01,  8.61554709e-02,
        1.15206978e-01,  4.63825057e-01,  1.05453903e+00,  1.77114286e+00,        2.37154066e+00,  2.57490121e+00,  2.36185682e+00,  2.16818011e+00,
        2.30375381e+00,  2.59426888e+00,  2.72015874e+00,  2.65237189e+00,        2.42964367e+00,  2.08102559e+00,  1.74209135e+00,  1.56778231e+00,
        1.47094395e+00,  1.27726724e+00,  9.86752177e-01,  8.02759301e-01,        8.51178479e-01,  1.02548752e+00,  1.11264204e+00,  1.01580368e+00,
        8.12443137e-01,  6.76869439e-01,  5.99398755e-01,  4.83192728e-01,        2.89516017e-01,  7.64716353e-02, -7.84697334e-02, -1.84991924e-01,
       -2.72146444e-01, -3.49617129e-01, -3.88352471e-01, -3.98036306e-01,       -3.78668635e-01, -2.72146444e-01, -4.94182268e-02,  3.08883688e-01,
        7.05920946e-01,  1.01580368e+00,  1.09327437e+00,  8.70546150e-01,        4.34773551e-01, -3.00505557e-02, -3.20565622e-01, -3.39933293e-01,
       -1.65624253e-01,  5.71039642e-02,  2.41096840e-01,  4.05722044e-01,        5.12244235e-01,  5.02560399e-01,  3.28251360e-01,  6.67877998e-02,
       -1.65624253e-01, -3.20565622e-01, -4.17403978e-01, -5.43293840e-01,       -7.36970551e-01, -8.82228084e-01, -8.91911919e-01, -8.04757399e-01,
       -7.46654386e-01, -7.85389728e-01, -8.91911919e-01, -9.88750275e-01,       -1.03716945e+00, -1.04685329e+00, -1.02748562e+00, -9.79066439e-01,
       -9.40331097e-01, -9.50014933e-01, -1.05653712e+00, -1.24537192e+00,       -1.45066923e+00, -1.59883191e+00, -1.63272534e+00, -1.53395022e+00,
       -1.32187422e+00, -1.04685329e+00, -7.56338222e-01, -5.14242333e-01,       -3.59300964e-01, -2.81830280e-01, -2.14043431e-01, -1.46256582e-01,
       -7.84697334e-02, -3.00505557e-02,  2.80524576e-02,  1.34574649e-01,        2.60464511e-01,  3.57302866e-01,  3.66986702e-01,  2.12045333e-01,
       -1.07521240e-01, -4.46455484e-01, -5.82029182e-01, -4.07720142e-01,       -5.91020623e-02,  2.99199853e-01,  6.18766426e-01,  8.99597657e-01,
        1.06422286e+00,  1.02548752e+00,  8.89913821e-01,  9.38332999e-01,        1.28695108e+00,  1.75177519e+00,  2.04229025e+00,  2.05197409e+00,
        1.91640039e+00,  1.76145902e+00,  1.59683382e+00,  1.42252478e+00,        1.18042889e+00,  8.12443137e-01,  3.47619031e-01, -5.91020623e-02,
       -2.14043431e-01, -5.91020623e-02,  2.79832182e-01,  4.73508893e-01,        3.08883688e-01, -2.04359596e-01, -7.46654386e-01, -1.00811795e+00,
       -8.82228084e-01, -4.85190826e-01, -4.94182268e-02,  1.92677662e-01,        1.44258484e-01, -5.91020623e-02, -1.94675760e-01, -1.84991924e-01,
       -1.07521240e-01, -8.81535690e-02, -1.55940418e-01, -2.52778773e-01,       -2.33411102e-01, -4.94182268e-02,  2.79832182e-01,  6.09082590e-01,
        7.73707795e-01,  7.64023959e-01,  7.44656288e-01,  8.70546150e-01,        1.15137738e+00,  1.39347327e+00,  1.39347327e+00,  1.18042889e+00,
        8.80229986e-01,  6.47817933e-01,  4.63825057e-01,  3.28251360e-01,        2.31413004e-01,  1.53942320e-01,  9.58393064e-02,  3.77362932e-02,
        6.67877998e-02,  2.02361497e-01,  4.63825057e-01,  7.64023959e-01,        1.02548752e+00,  1.16106122e+00,  1.15137738e+00,  1.00611985e+00,
        8.31810808e-01,  6.96237110e-01,  5.89714919e-01,  4.92876564e-01,        4.44457386e-01,  4.92876564e-01,  6.28450262e-01,  7.05920946e-01,
        6.38134097e-01,  5.12244235e-01,  4.63825057e-01,  5.02560399e-01,        5.21928071e-01,  3.86354373e-01,  8.61554709e-02, -2.62462609e-01,
       -5.43293840e-01, -6.59499866e-01, -6.01396853e-01, -4.75506991e-01,       -3.68984800e-01, -2.91514115e-01, -2.14043431e-01, -1.17205076e-01,
       -4.94182268e-02, -1.17205076e-01, -3.30249458e-01, -5.33610004e-01,       -5.14242333e-01, -1.94675760e-01,  2.31413004e-01,  4.34773551e-01,
        2.70148346e-01, -1.36572747e-01, -4.94874662e-01, -6.69183702e-01,       -6.98235208e-01, -7.27286715e-01, -8.43492742e-01, -1.03716945e+00,
       -1.22213071e+00, -1.26280282e+00, -1.11464014e+00, -8.24125071e-01,       -5.52977675e-01, -4.17403978e-01, -4.46455484e-01, -5.23926169e-01,
       -5.33610004e-01, -4.85190826e-01, -4.17403978e-01, -3.68984800e-01,       -3.10881787e-01, -2.72146444e-01, -2.72146444e-01, -3.68984800e-01,
       -5.82029182e-01, -8.43492742e-01, -1.07590479e+00, -1.19307920e+00,       -1.18339537e+00, -1.09527247e+00, -9.88750275e-01, -8.72544248e-01,
       -7.36970551e-01, -6.01396853e-01, -5.82029182e-01, -7.07919044e-01,       -8.91911919e-01, -1.01780178e+00, -1.01780178e+00, -9.11279590e-01,
       -7.36970551e-01, -5.62661511e-01, -4.65823155e-01, -4.36771649e-01,       -4.36771649e-01, -3.59300964e-01, -8.81535690e-02,  4.15405879e-01,
        9.48016835e-01,  1.12232587e+00,  8.80229986e-01,  5.02560399e-01,        2.02361497e-01,  2.80524576e-02, -9.78374045e-02, -2.23727267e-01,
       -3.49617129e-01, -4.36771649e-01, -3.98036306e-01, -1.55940418e-01,        2.41096840e-01,  6.28450262e-01,  8.99597657e-01,  1.07390670e+00,
        1.22884807e+00,  1.33537026e+00,  1.21916423e+00,  9.09281492e-01,        6.47817933e-01,  7.05920946e-01,  1.03517135e+00,  1.25789957e+00,
        1.10295820e+00,  6.57501768e-01,  2.60464511e-01,  1.44258484e-01,        3.28251360e-01,  6.28450262e-01,  8.12443137e-01,  8.22126972e-01,
        7.34972453e-01,  6.09082590e-01,  4.15405879e-01,  1.63626155e-01,       -6.87858979e-02, -2.04359596e-01, -2.23727267e-01, -7.84697334e-02,
        2.89516017e-01,  8.31810808e-01,  1.25789957e+00,  1.16106122e+00,        5.89714919e-01, -3.97343912e-02, -3.39933293e-01, -3.39933293e-01,
       -2.04359596e-01,  2.80524576e-02,  4.05722044e-01,  8.12443137e-01,        1.07390670e+00,  1.17074505e+00,  1.17074505e+00,  1.14169355e+00,
        1.11264204e+00,  1.05453903e+00,  8.60862315e-01,  5.89714919e-01,        3.86354373e-01,  3.86354373e-01,  5.60663413e-01,  8.51178479e-01,
        1.14169355e+00,  1.38378943e+00,  1.54841464e+00,  1.64525299e+00,        1.63556916e+00,  1.55809847e+00,  1.41284094e+00,  1.19979656e+00,
        9.57700670e-01,  7.34972453e-01,  5.41295742e-01,  3.76670537e-01,        2.89516017e-01,  3.47619031e-01,  4.92876564e-01,  5.89714919e-01,
        5.12244235e-01,  2.70148346e-01, -7.84697334e-02, -4.65823155e-01,       -8.14441235e-01, -1.03716945e+00, -1.09527247e+00, -1.02748562e+00,
       -8.53176577e-01, -6.11080689e-01, -3.59300964e-01, -1.84991924e-01,       -1.07521240e-01, -9.78374045e-02, -8.81535690e-02, -7.84697334e-02,
       -7.84697334e-02, -8.81535690e-02, -7.84697334e-02, -3.97343912e-02,       -1.06828846e-02, -3.97343912e-02, -1.46256582e-01, -3.10881787e-01,
       -4.65823155e-01, -5.62661511e-01, -5.82029182e-01, -5.62661511e-01,       -5.52977675e-01, -6.11080689e-01, -7.07919044e-01, -8.43492742e-01,
       -9.50014933e-01, -9.98434110e-01, -9.69382604e-01, -9.11279590e-01,       -9.01595755e-01, -9.69382604e-01, -1.11464014e+00, -1.27539181e+00,
       -1.39062945e+00, -1.44389055e+00, -1.48068912e+00, -1.55331789e+00,       -1.67436583e+00, -1.80316084e+00, -1.88644183e+00, -1.90290435e+00]

function LHS(func,N,lower,upper;n_int=1000)
                samples = zeros(N)
                x = range(lower,stop=upper,length=n_int)
                total_area = trapz(x,func.(x))
                single_area = total_area/N
                left = lower
                for i = 1:N
                                f(x) = single_area - trapz(range(left,stop=x[1],length=n_int),func.(range(left,stop=x[1],length=n_int)))
                                xstar, _ = brent(f, left, left+upper)
                                samples[i] = rand(1)[1]*(xstar-left) + left
                                left = xstar
                end
                shuffle!(samples)
                return samples
end
g(x) = 1/sqrt(2.0*pi)*exp(-0.5*x[1]^2)

lower = -4.0
upper = 4.0
nCycles = 120

# turb_samples = turb_samples_low[1:nCycles*naz]
# turb_samples = turb_samples/std(turb_samples)

# turb_samples = LHS(g,nCycles*naz,lower,upper)
# println(turb_samples)


ntime = 5.0*nCycles
narrs = Int(round(ntime/600.0) + 1)

samp_spl = copy(turb_samples_low)
for i = 1:narrs-1
    append!(samp_spl,turb_samples_low)
end

t_spl = range(0.0,stop=600*narrs,length=length(turb_samples_low)*narrs)
spl = Akima(t_spl,samp_spl)

sample_times = range(0.0,stop=ntime,length=naz*nCycles)

turb_samples = spl.(sample_times)
turb_samples = turb_samples.-mean(turb_samples)
turb_samples = turb_samples./std(turb_samples)

# append!(turb_samples,turb_samples)
turbine_ID = 2
state_ID = 1

ambient_ti = [0.046]
turb = "low"
# ambient_ti = [0.08]
# turb = "high"

# pitches = zeros(length(speeds))
# pitch_func = Akima(speeds, pitches)

# ds = 1.5
# dt = 2.7
# ambient_ti = [0.046]
# turb = "low"
# ds = 2.2
# dt = 2.5
# ambient_ti = [0.000000001]
# turb = "low"
# ds = 1.5
# dt = 2.7
# ws = wind_speed

off = range(-1.0,stop=1.0,length=100)
off = [-0.6]
ws_arr = [13.0]
run = true
sep_arr = [4.0,7.0,10.0]
# sep_arr = [2.0,4.0,6.0]
sep_arr = [4.0]


# k1 = 0.15
# k2 = 0.0
# alpha_star = 8.059490825809203
# beta_star = 0.0
# wec_factor = 1.0
# wakedeficitmodel = ff.GaussYawVariableSpread(alpha_star, beta_star, k1, k2, wec_factor)
# local_ti_model = ff.LocalTIModelMaxTI(alpha_star, beta_star, k1, k2)
# model_set = ff.WindFarmModelSet(wakedeficitmodel,wakedeflectionmodel,wakecombinationmodel,local_ti_model)

# npts = 100
# rad = rand(npts)
# ang = rand(npts).*2*pi
# rotor_points_y = zeros(npts)
# rotor_points_z = zeros(npts)
# for i = 1:npts
#        rotor_points_y[i] = rad[i]*cos(ang[i])
#        rotor_points_z[i] = rad[i]*sin(ang[i])
# end

plotting = false

if plotting == true
    figure(1,figsize=(6,2.5))
end
for w = 1:length(sep_arr)
                sep = sep_arr[w]
                turbine_x = [0.0,sep*rotor_diameter[1]]
                for j = 1:length(ws_arr)
                    if run == true
                        windspeeds = [ws_arr[j]]
                        windresource = ff.DiscretizedWindResource(winddirections, windspeeds, windprobabilities, measurementheight, air_density, ambient_ti, wind_shear_model)

                        # ws_eff = 13.0
                        alpha_star,beta_star,k1,k2 = get_coeffs(ws_arr[j],turb)
                        # alpha_star = 4.859453751668387
                        # beta_star = 0.3521952853552008
                        # k1 = 0.18988806762879362
                        # k2 = 0.0012797446159086834
                        # alpha_star,beta_star,k1,k2 = get_coeffs(ws_eff,TI)
                        wakedeficitmodel = ff.GaussYawVariableSpread(alpha_star, beta_star, k1, k2, wec_factor)
                        local_ti_model = ff.LocalTIModelMaxTI(alpha_star, beta_star, k1, k2)
                        model_set = ff.WindFarmModelSet(wakedeficitmodel,wakedeflectionmodel,wakecombinationmodel,local_ti_model)

                        ds,dt = getTI_coeffs(ws_arr[j],turb)
                        # ds,dt = getTI_coeffs(ws_eff,turb)
                        # ds = 2.38512084848453
                        # dt = 1.1841406781776536

                        start = time()

                        global t1_damage
                        global t2_damage

                        t1_damage = zeros(length(off))

                        for k=1:length(off)

                            global t1_damage
                            global t2_damage

                            # println("offset: ", off[k])
                            offset = off[k]*rotor_diameter[1]
                            turbine_y = [0.0,offset]

                            t1 = time()
                            # rotor_points_y = [0.0]
                            # rotor_points_z = [0.0]
                            rs = [0.5,1.0]
                            ts = deg2rad.([0.0,45.0,90.0,135.0,180.0,225.0,270.0,315.0])
                            rotor_points_y = zeros(length(rs)*length(ts))
                            rotor_points_z = zeros(length(rs)*length(ts))
                            counter = 1
                            for m = 1:length(rs)
                                for n = 1:length(ts)
                                    rotor_points_y[counter] = rs[m]*cos(ts[n])
                                    rotor_points_z[counter] = rs[m]*sin(ts[n])
                                    counter += 1
                                end
                            end
                            append!(rotor_points_y,0.0)
                            append!(rotor_points_z,0.0)

                            turbine_velocities, turbine_ct, turbine_ai, turbine_local_ti = ff.turbine_velocities_one_direction(turbine_x, turbine_y, turbine_z, rotor_diameter, hub_height, turbine_yaw,
                                                sorted_turbine_index, ct_model, rotor_points_y, rotor_points_z, windresource,
                                                model_set; wind_farm_state_id=1)
                            # turbine_ct = [0.7620929940139257, 0.7620929940139257]
                            # println(turbine_velocities)
                            # t1_damage[k] = ff.get_single_damage_super(turbine_x,turbine_y,turbine_z,rotor_diameter,hub_height,turbine_yaw,turbine_ai,sorted_turbine_index,turbine_ID,state_ID,nCycles,az_arr,
                            #     turb_samples,omega_func,pitch_func,ff.GaussianTI,r,sections,Rhub,Rtip,precone,tilt,windresource,model_set,turbine_velocities, turbine_ct,turbine_local_ti,Nlocs=Nlocs,fos=1.15)#,div_sigma=2.0, div_ti=2.0)
                            # t1_damage[k] = ff.get_single_damage_super_NEW(turbine_x,turbine_y,turbine_z,rotor_diameter,hub_height,turbine_yaw,turbine_ai,sorted_turbine_index,turbine_ID,state_ID,nCycles,az_arr,
                            #     turb_samples,omega_func,pitch_func,ff.GaussianTI,r,sections,Rhub,Rtip,precone,tilt,windresource,model_set,turbine_velocities, turbine_ct,turbine_local_ti,Nlocs=Nlocs,fos=1.15,div_sigma=ds, div_ti=dt)



                            # t1_damage[k] = ff.get_single_damage_FINAL(turbine_x,turbine_y,turbine_z,rotor_diameter,hub_height,turbine_yaw,turbine_ai,sorted_turbine_index,turbine_ID,state_ID,nCycles,az_arr,
                            #     turb_samples,omega_func,pitch_func,ff.GaussianTI,r,sections,Rhub,Rtip,precone,tilt,windresource,model_set,turbine_velocities, turbine_ct,turbine_local_ti,Nlocs=Nlocs,fos=1.15,div_sigma=ds, div_ti=dt)

                            # t1_damage[k] = ff.get_single_state_damage_FINAL(turbine_x,turbine_y,turbine_z,rotor_diameter,hub_height,turbine_yaw,turbine_ai,sorted_turbine_index,ct_model,
                            #                    state_ID,nCycles,az_arr,turb_samples,pitch_func,ff.GaussianTI,r,sections,Rhub,Rtip,precone,tilt,
                            #                    windresource,model_set;
                            #                    Nlocs=Nlocs,fos=1.15,div_sigma=ds,div_ti=dt)[2]

                            # t1_damage[k] = ff.get_total_farm_damage_FINAL(turbine_x,turbine_y,turbine_z,rotor_diameter,hub_height,turbine_yaw,ct_model,
                            #         nCycles,az_arr,turb_samples,pitch_func,ff.GaussianTI,r,sections,Rhub,Rtip,precone,tilt,windresource,model_set;
                            #         Nlocs=Nlocs,fos=1.15,div_sigma=ds,div_ti=dt)[2]

                            t1_damage[k] = ff.get_single_damage_FINAL(turbine_x,turbine_y,turbine_z,rotor_diameter,hub_height,turbine_yaw,turbine_ai,sorted_turbine_index,turbine_ID,state_ID,nCycles,az_arr,
                                turb_samples,pitch_func,ff.GaussianTI,r,sections,Rhub,Rtip,precone,tilt,windresource,model_set,
                                turbine_velocities, turbine_ct,turbine_local_ti;
                                Nlocs=Nlocs,fos=1.15,div_sigma=ds,div_ti=dt)

                            # # println(time()-t1)
                        end

                        # turb = "high"
                        if plotting == true
                            if w == 1 && j == 1
                                            subplot(131)
                                            title("4 D",fontsize=10)
                                            # ylabel(string("damage\n", L"$U_\infty = 13$ m/s"))
                                            tick_params(
                                                        axis="y",          # changes apply to the x-axis
                                                        which="both",      # both major and minor ticks are affected
                                                        right=false,      # ticks along the bottom edge are off
                                                        top=false,         # ticks along the top edge are off
                                                        labelright=false) # labels along the bottom edge are off
                                xlabel("offset (D)")
                            elseif w == 2 && j == 1
                                            subplot(132)
                                            title("7 D",fontsize=10)
                                            tick_params(
                                                        axis="y",          # changes apply to the x-axis
                                                        which="both",      # both major and minor ticks are affected
                                                        right=false,      # ticks along the bottom edge are off
                                                        top=false,         # ticks along the top edge are off
                                                        labelright=false,
                                                        labelleft=false) # labels along the bottom edge are off
                                xlabel("offset (D)")
                            elseif w == 3 && j == 1
                                            subplot(133)
                                            title("10 D",fontsize=10)
                                            tick_params(
                                                        axis="y",          # changes apply to the x-axis
                                                        which="both",      # both major and minor ticks are affected
                                                        right=false,      # ticks along the bottom edge are off
                                                        top=false,         # ticks along the top edge are off
                                                        labelright=false,
                                                        labelleft=false) # labels along the bottom edge are off
                                xlabel("offset (D)")
                           end


                            # include("FAST_data.jl")
                            include("FAST_data_NEW.jl")
                            FS,FD = fastdata(turb,ws_arr[j],sep)
                            # wsn = 13.0
                            # FS,FD = fastdata(turb,wsn,sep)

                            if w == 3 && j == 1
                                            plot(FS,FD,"o",markersize=5,label="SOWFA/\nOpenFAST")
                                            plot(off,t1_damage,label="model")
                                            legend(loc=1)
                            else
                                            plot(FS,FD,"o",markersize=5)
                                            plot(off,t1_damage)
                            end

                            #
                            #



                            # title("$sep, 13 m/s")
                            ylim(-0.1,3.0)
                            # ylim(-0.1,.0)
                            # ylim(0.0,1.1)
                     end
                    end
                #     # legend(["model", "FAST"])
                #     # legend(["10 m/s","","11 m/s","","12m/s",""])
                end
end
# suptitle("8% turbulence intensity",y=0.97)
# subplots_adjust(top=0.91,bottom=0.19,left=0.13,right=0.99,wspace=0.1,hspace=0.1)
# savefig("damage_13.pdf",transparent=true)
